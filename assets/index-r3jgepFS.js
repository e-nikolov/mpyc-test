import{E as W}from"./encode-GRFFunDQ.js";import{B as et}from"./index-Z1m4Mu8Y.js";var ye;try{ye=new TextDecoder}catch{}var o,F,n=0,E={},m,X,z=0,$=0,M,q,j=[],b,Ie={useRecords:!1,mapsAsObjects:!0};class Fe{}const Je=new Fe;Je.name="MessagePack 0xC1";var G=!1,$e=2,_e;try{new Function("")}catch{$e=1/0}class re{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(o)return Ge(()=>(Se(),this?this.unpack(e,t):re.prototype.unpack.call(Ie,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof t=="object"?(F=t.end||e.length,n=t.start||0):(n=0,F=t>-1?t:e.length),$=0,X=null,M=null,o=e;try{b=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(f){throw o=null,e instanceof Uint8Array?f:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof re){if(E=this,this.structures)return m=this.structures,fe(t);(!m||m.length>0)&&(m=[])}else E=Ie,(!m||m.length>0)&&(m=[]);return fe(t)}unpackMultiple(e,t){let f,s=0;try{G=!0;let c=e.length,h=this?this.unpack(e,c):ce.unpack(e,c);if(t){if(t(h,s,n)===!1)return;for(;n<c;)if(s=n,t(fe(),s,n)===!1)return}else{for(f=[h];n<c;)s=n,f.push(fe());return f}}catch(c){throw c.lastPosition=s,c.values=f,c}finally{G=!1,Se()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(f=>f.slice(0)));for(let f=0,s=e.length;f<s;f++){let c=e[f];c&&(c.isShared=!0,f>=32&&(c.highByte=f-32>>5))}e.sharedLength=e.length;for(let f in t||[])if(f>=0){let s=e[f],c=t[f];c&&(s&&((e.restoreStructures||(e.restoreStructures=[]))[f]=s),e[f]=c)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function fe(r){try{if(!E.trusted&&!G){let t=m.sharedLength||0;t<m.length&&(m.length=t)}let e;if(E.randomAccessStructure&&o[n]<64&&o[n]>=32&&_e?(e=_e(o,n,F,E),o=null,!(r&&r.lazy)&&e&&(e=e.toJSON()),n=F):e=_(),M&&(n=M.postBundlePosition,M=null),G&&(m.restoreStructures=null),n==F)m&&m.restoreStructures&&Te(),m=null,o=null,q&&(q=null);else{if(n>F)throw new Error("Unexpected end of MessagePack data");if(!G){let t;try{t=JSON.stringify(e,(f,s)=>typeof s=="bigint"?`${s}n`:s).slice(0,100)}catch(f){t="(JSON view not available "+f+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw m&&m.restoreStructures&&Te(),Se(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||n>F)&&(e.incomplete=!0),e}}function Te(){for(let r in m.restoreStructures)m[r]=m.restoreStructures[r];m.restoreStructures=null}function _(){let r=o[n++];if(r<160)if(r<128){if(r<64)return r;{let e=m[r&63]||E.getStructures&&qe()[r&63];return e?(e.read||(e.read=be(e,r&63)),e.read()):r}}else if(r<144)if(r-=128,E.mapsAsObjects){let e={};for(let t=0;t<r;t++){let f=Ze();f==="__proto__"&&(f="__proto_"),e[f]=_()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(_(),_());return e}else{r-=144;let e=new Array(r);for(let t=0;t<r;t++)e[t]=_();return E.freezeData?Object.freeze(e):e}else if(r<192){let e=r-160;if($>=n)return X.slice(n-z,(n+=e)-z);if($==0&&F<140){let t=e<16?me(e):Ke(e);if(t!=null)return t}return we(e)}else{let e;switch(r){case 192:return null;case 193:return M?(e=_(),e>0?M[1].slice(M.position1,M.position1+=e):M[0].slice(M.position0,M.position0-=e)):Je;case 194:return!1;case 195:return!0;case 196:if(e=o[n++],e===void 0)throw new Error("Unexpected end of buffer");return he(e);case 197:return e=b.getUint16(n),n+=2,he(e);case 198:return e=b.getUint32(n),n+=4,he(e);case 199:return Q(o[n++]);case 200:return e=b.getUint16(n),n+=2,Q(e);case 201:return e=b.getUint32(n),n+=4,Q(e);case 202:if(e=b.getFloat32(n),E.useFloat32>2){let t=Ue[(o[n]&127)<<1|o[n+1]>>7];return n+=4,(t*e+(e>0?.5:-.5)>>0)/t}return n+=4,e;case 203:return e=b.getFloat64(n),n+=8,e;case 204:return o[n++];case 205:return e=b.getUint16(n),n+=2,e;case 206:return e=b.getUint32(n),n+=4,e;case 207:return E.int64AsType==="number"?(e=b.getUint32(n)*4294967296,e+=b.getUint32(n+4)):E.int64AsType==="string"?e=b.getBigUint64(n).toString():E.int64AsType==="auto"?(e=b.getBigUint64(n),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=b.getBigUint64(n),n+=8,e;case 208:return b.getInt8(n++);case 209:return e=b.getInt16(n),n+=2,e;case 210:return e=b.getInt32(n),n+=4,e;case 211:return E.int64AsType==="number"?(e=b.getInt32(n)*4294967296,e+=b.getUint32(n+4)):E.int64AsType==="string"?e=b.getBigInt64(n).toString():E.int64AsType==="auto"?(e=b.getBigInt64(n),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=b.getBigInt64(n),n+=8,e;case 212:if(e=o[n++],e==114)return je(o[n++]&63);{let t=j[e];if(t)return t.read?(n++,t.read(_())):t.noBuffer?(n++,t()):t(o.subarray(n,++n));throw new Error("Unknown extension "+e)}case 213:return e=o[n],e==114?(n++,je(o[n++]&63,o[n++])):Q(2);case 214:return Q(4);case 215:return Q(8);case 216:return Q(16);case 217:return e=o[n++],$>=n?X.slice(n-z,(n+=e)-z):rt(e);case 218:return e=b.getUint16(n),n+=2,$>=n?X.slice(n-z,(n+=e)-z):nt(e);case 219:return e=b.getUint32(n),n+=4,$>=n?X.slice(n-z,(n+=e)-z):it(e);case 220:return e=b.getUint16(n),n+=2,Me(e);case 221:return e=b.getUint32(n),n+=4,Me(e);case 222:return e=b.getUint16(n),n+=2,Pe(e);case 223:return e=b.getUint32(n),n+=4,Pe(e);default:if(r>=224)return r-256;if(r===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+r)}}}const tt=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function be(r,e){function t(){if(t.count++>$e){let s=r.read=new Function("r","return function(){return "+(E.freezeData?"Object.freeze":"")+"({"+r.map(c=>c==="__proto__"?"__proto_:r()":tt.test(c)?c+":r()":"["+JSON.stringify(c)+"]:r()").join(",")+"})}")(_);return r.highByte===0&&(r.read=Re(e,r.read)),s()}let f={};for(let s=0,c=r.length;s<c;s++){let h=r[s];h==="__proto__"&&(h="__proto_"),f[h]=_()}return E.freezeData?Object.freeze(f):f}return t.count=0,r.highByte===0?Re(e,t):t}const Re=(r,e)=>function(){let t=o[n++];if(t===0)return e();let f=r<32?-(r+(t<<5)):r+(t<<5),s=m[f]||qe()[f];if(!s)throw new Error("Record id is not defined for "+f);return s.read||(s.read=be(s,r)),s.read()};function qe(){let r=Ge(()=>(o=null,E.getStructures()));return m=E._mergeStructures(r,m)}var we=ne,rt=ne,nt=ne,it=ne;function ne(r){let e;if(r<16&&(e=me(r)))return e;if(r>64&&ye)return ye.decode(o.subarray(n,n+=r));const t=n+r,f=[];for(e="";n<t;){const s=o[n++];if(!(s&128))f.push(s);else if((s&224)===192){const c=o[n++]&63;f.push((s&31)<<6|c)}else if((s&240)===224){const c=o[n++]&63,h=o[n++]&63;f.push((s&31)<<12|c<<6|h)}else if((s&248)===240){const c=o[n++]&63,h=o[n++]&63,S=o[n++]&63;let O=(s&7)<<18|c<<12|h<<6|S;O>65535&&(O-=65536,f.push(O>>>10&1023|55296),O=56320|O&1023),f.push(O)}else f.push(s);f.length>=4096&&(e+=R.apply(String,f),f.length=0)}return f.length>0&&(e+=R.apply(String,f)),e}function Me(r){let e=new Array(r);for(let t=0;t<r;t++)e[t]=_();return E.freezeData?Object.freeze(e):e}function Pe(r){if(E.mapsAsObjects){let e={};for(let t=0;t<r;t++){let f=Ze();f==="__proto__"&&(f="__proto_"),e[f]=_()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(_(),_());return e}}var R=String.fromCharCode;function Ke(r){let e=n,t=new Array(r);for(let f=0;f<r;f++){const s=o[n++];if((s&128)>0){n=e;return}t[f]=s}return R.apply(String,t)}function me(r){if(r<4)if(r<2){if(r===0)return"";{let e=o[n++];if((e&128)>1){n-=1;return}return R(e)}}else{let e=o[n++],t=o[n++];if((e&128)>0||(t&128)>0){n-=2;return}if(r<3)return R(e,t);let f=o[n++];if((f&128)>0){n-=3;return}return R(e,t,f)}else{let e=o[n++],t=o[n++],f=o[n++],s=o[n++];if((e&128)>0||(t&128)>0||(f&128)>0||(s&128)>0){n-=4;return}if(r<6){if(r===4)return R(e,t,f,s);{let c=o[n++];if((c&128)>0){n-=5;return}return R(e,t,f,s,c)}}else if(r<8){let c=o[n++],h=o[n++];if((c&128)>0||(h&128)>0){n-=6;return}if(r<7)return R(e,t,f,s,c,h);let S=o[n++];if((S&128)>0){n-=7;return}return R(e,t,f,s,c,h,S)}else{let c=o[n++],h=o[n++],S=o[n++],O=o[n++];if((c&128)>0||(h&128)>0||(S&128)>0||(O&128)>0){n-=8;return}if(r<10){if(r===8)return R(e,t,f,s,c,h,S,O);{let P=o[n++];if((P&128)>0){n-=9;return}return R(e,t,f,s,c,h,S,O,P)}}else if(r<12){let P=o[n++],T=o[n++];if((P&128)>0||(T&128)>0){n-=10;return}if(r<11)return R(e,t,f,s,c,h,S,O,P,T);let C=o[n++];if((C&128)>0){n-=11;return}return R(e,t,f,s,c,h,S,O,P,T,C)}else{let P=o[n++],T=o[n++],C=o[n++],J=o[n++];if((P&128)>0||(T&128)>0||(C&128)>0||(J&128)>0){n-=12;return}if(r<14){if(r===12)return R(e,t,f,s,c,h,S,O,P,T,C,J);{let D=o[n++];if((D&128)>0){n-=13;return}return R(e,t,f,s,c,h,S,O,P,T,C,J,D)}}else{let D=o[n++],Y=o[n++];if((D&128)>0||(Y&128)>0){n-=14;return}if(r<15)return R(e,t,f,s,c,h,S,O,P,T,C,J,D,Y);let L=o[n++];if((L&128)>0){n-=15;return}return R(e,t,f,s,c,h,S,O,P,T,C,J,D,Y,L)}}}}}function Ce(){let r=o[n++],e;if(r<192)e=r-160;else switch(r){case 217:e=o[n++];break;case 218:e=b.getUint16(n),n+=2;break;case 219:e=b.getUint32(n),n+=4;break;default:throw new Error("Expected string")}return ne(e)}function he(r){return E.copyBuffers?Uint8Array.prototype.slice.call(o,n,n+=r):o.subarray(n,n+=r)}function Q(r){let e=o[n++];if(j[e]){let t;return j[e](o.subarray(n,t=n+=r),f=>{n=f;try{return _()}finally{n=t}})}else throw new Error("Unknown extension type "+e)}var Ne=new Array(4096);function Ze(){let r=o[n++];if(r>=160&&r<192){if(r=r-160,$>=n)return X.slice(n-z,(n+=r)-z);if(!($==0&&F<180))return we(r)}else return n--,_().toString();let e=(r<<5^(r>1?b.getUint16(n):r>0?o[n]:0))&4095,t=Ne[e],f=n,s=n+r-3,c,h=0;if(t&&t.bytes==r){for(;f<s;){if(c=b.getUint32(f),c!=t[h++]){f=1879048192;break}f+=4}for(s+=3;f<s;)if(c=o[f++],c!=t[h++]){f=1879048192;break}if(f===s)return n=f,t.string;s-=3,f=n}for(t=[],Ne[e]=t,t.bytes=r;f<s;)c=b.getUint32(f),t.push(c),f+=4;for(s+=3;f<s;)c=o[f++],t.push(c);let S=r<16?me(r):Ke(r);return S!=null?t.string=S:t.string=we(r)}const je=(r,e)=>{let t=_().map(c=>c.toString()),f=r;e!==void 0&&(r=r<32?-((e<<5)+r):(e<<5)+r,t.highByte=e);let s=m[r];return s&&(s.isShared||G)&&((m.restoreStructures||(m.restoreStructures=[]))[r]=s),m[r]=t,t.read=be(t,f),t.read()};j[0]=()=>{};j[0].noBuffer=!0;j[66]=r=>{let e=r.length,t=BigInt(r[0]&128?r[0]-256:r[0]);for(let f=1;f<e;f++)t<<=8n,t+=BigInt(r[f]);return t};let st={Error,TypeError,ReferenceError};j[101]=()=>{let r=_();return(st[r[0]]||Error)(r[1])};j[105]=r=>{let e=b.getUint32(n-4);q||(q=new Map);let t=o[n],f;t>=144&&t<160||t==220||t==221?f=[]:f={};let s={target:f};q.set(e,s);let c=_();return s.used?Object.assign(f,c):(s.target=c,c)};j[112]=r=>{let e=b.getUint32(n-4),t=q.get(e);return t.used=!0,t.target};j[115]=()=>new Set(_());const Xe=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array");let ft=typeof globalThis=="object"?globalThis:window;j[116]=r=>{let e=r[0],t=Xe[e];if(!t)throw new Error("Could not find typed array for code "+e);return new ft[t](Uint8Array.prototype.slice.call(r,1).buffer)};j[120]=()=>{let r=_();return new RegExp(r[0],r[1])};const lt=[];j[98]=r=>{let e=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],t=n;return n+=e-r.length,M=lt,M=[Ce(),Ce()],M.position0=0,M.position1=0,M.postBundlePosition=n,n=t,_()};j[255]=r=>r.length==4?new Date((r[0]*16777216+(r[1]<<16)+(r[2]<<8)+r[3])*1e3):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+((r[3]&3)*4294967296+r[4]*16777216+(r[5]<<16)+(r[6]<<8)+r[7])*1e3):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+((r[4]&128?-281474976710656:0)+r[6]*1099511627776+r[7]*4294967296+r[8]*16777216+(r[9]<<16)+(r[10]<<8)+r[11])*1e3):new Date("invalid");function Ge(r){let e=F,t=n,f=z,s=$,c=X,h=q,S=M,O=new Uint8Array(o.slice(0,F)),P=m,T=m.slice(0,m.length),C=E,J=G,D=r();return F=e,n=t,z=f,$=s,X=c,q=h,M=S,o=O,G=J,m=P,m.splice(0,m.length,...T),E=C,b=new DataView(o.buffer,o.byteOffset,o.byteLength),D}function Se(){o=null,q=null,m=null}const Ue=new Array(147);for(let r=0;r<256;r++)Ue[r]=+("1e"+Math.floor(45.15-r*.30103));var ce=new re({useRecords:!1});ce.unpack;ce.unpackMultiple;ce.unpack;let ut=new Float32Array(1);new Uint8Array(ut.buffer,0,4);let ue;try{ue=new TextEncoder}catch{}let pe,Ye;const ae=typeof Buffer<"u",le=ae?function(r){return Buffer.allocUnsafeSlow(r)}:Uint8Array,He=ae?Buffer:Uint8Array,De=ae?4294967296:2144337920;let l,te,B,i=0,N,A=null,ct;const at=21760,ot=/[\u0080-\uFFFF]/,v=Symbol("record-id");class Qe extends re{constructor(e){super(e),this.offset=0;let t,f,s,c,h=He.prototype.utf8Write?function(u,g){return l.utf8Write(u,g,4294967295)}:ue&&ue.encodeInto?function(u,g){return ue.encodeInto(u,l.subarray(g)).written}:!1,S=this;e||(e={});let O=e&&e.sequential,P=e.structures||e.saveStructures,T=e.maxSharedStructures;if(T==null&&(T=P?32:0),T>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let C=e.maxOwnStructures;C==null&&(C=P?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let J=T>32||C+T>64,D=T+64,Y=T+C+64;if(Y>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let L=[],oe=0,ie=0;this.pack=this.encode=function(u,g){if(l||(l=new le(8192),B=l.dataView||(l.dataView=new DataView(l.buffer,0,8192)),i=0),N=l.length-10,N-i<2048?(l=new le(l.length),B=l.dataView||(l.dataView=new DataView(l.buffer,0,l.length)),N=l.length-10,i=0):i=i+7&2147483640,t=i,g&wt&&(i+=g&255),c=S.structuredClone?new Map:null,S.bundleStrings&&typeof u!="string"?(A=[],A.size=1/0):A=null,s=S.structures,s){s.uninitialized&&(s=S._mergeStructures(S.getStructures()));let a=s.sharedLength||0;if(a>T)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+s.sharedLength);if(!s.transitions){s.transitions=Object.create(null);for(let x=0;x<a;x++){let p=s[x];if(!p)continue;let y,w=s.transitions;for(let k=0,U=p.length;k<U;k++){let V=p[k];y=w[V],y||(y=w[V]=Object.create(null)),w=y}w[v]=x+64}this.lastNamedStructuresLength=a}O||(s.nextId=a+64)}f&&(f=!1);let d;try{S.randomAccessStructure&&u&&u.constructor&&u.constructor===Object?ve(u):I(u);let a=A;if(A&&ze(t,I,0),c&&c.idsToInsert){let x=c.idsToInsert.sort((k,U)=>k.offset>U.offset?1:-1),p=x.length,y=-1;for(;a&&p>0;){let k=x[--p].offset+t;k<a.stringsPosition+t&&y===-1&&(y=0),k>a.position+t?y>=0&&(y+=6):(y>=0&&(B.setUint32(a.position+t,B.getUint32(a.position+t)+y),y=-1),a=a.previous,p++)}y>=0&&a&&B.setUint32(a.position+t,B.getUint32(a.position+t)+y),i+=x.length*6,i>N&&K(i),S.offset=i;let w=dt(l.subarray(t,i),x);return c=null,w}return S.offset=i,g&gt?(l.start=t,l.end=i,l):l.subarray(t,i)}catch(a){throw d=a,a}finally{if(s&&(Be(),f&&S.saveStructures)){let a=s.sharedLength||0,x=l.subarray(t,i),p=ht(s,S);if(!d)return S.saveStructures(p,p.isCompatible)===!1?S.pack(u,g):(S.lastNamedStructuresLength=a,x)}g&yt&&(i=t)}};const Be=()=>{ie<10&&ie++;let u=s.sharedLength||0;if(s.length>u&&!O&&(s.length=u),oe>1e4)s.transitions=null,ie=0,oe=0,L.length>0&&(L=[]);else if(L.length>0&&!O){for(let g=0,d=L.length;g<d;g++)L[g][v]=0;L=[]}},xe=u=>{var g=u.length;g<16?l[i++]=144|g:g<65536?(l[i++]=220,l[i++]=g>>8,l[i++]=g&255):(l[i++]=221,B.setUint32(i,g),i+=4);for(let d=0;d<g;d++)I(u[d])},I=u=>{i>N&&(l=K(i));var g=typeof u,d;if(g==="string"){let a=u.length;if(A&&a>=4&&a<4096){if((A.size+=a)>at){let w,k=(A[0]?A[0].length*3+A[1].length:0)+10;i+k>N&&(l=K(i+k));let U;A.position?(U=A,l[i]=200,i+=3,l[i++]=98,w=i-t,i+=4,ze(t,I,0),B.setUint16(w+t-3,i-t-w)):(l[i++]=214,l[i++]=98,w=i-t,i+=4),A=["",""],A.previous=U,A.size=0,A.position=w}let y=ot.test(u);A[y?0:1]+=u,l[i++]=193,I(y?-a:a);return}let x;a<32?x=1:a<256?x=2:a<65536?x=3:x=5;let p=a*3;if(i+p>N&&(l=K(i+p)),a<64||!h){let y,w,k,U=i+x;for(y=0;y<a;y++)w=u.charCodeAt(y),w<128?l[U++]=w:w<2048?(l[U++]=w>>6|192,l[U++]=w&63|128):(w&64512)===55296&&((k=u.charCodeAt(y+1))&64512)===56320?(w=65536+((w&1023)<<10)+(k&1023),y++,l[U++]=w>>18|240,l[U++]=w>>12&63|128,l[U++]=w>>6&63|128,l[U++]=w&63|128):(l[U++]=w>>12|224,l[U++]=w>>6&63|128,l[U++]=w&63|128);d=U-i-x}else d=h(u,i+x);d<32?l[i++]=160|d:d<256?(x<2&&l.copyWithin(i+2,i+1,i+1+d),l[i++]=217,l[i++]=d):d<65536?(x<3&&l.copyWithin(i+3,i+2,i+2+d),l[i++]=218,l[i++]=d>>8,l[i++]=d&255):(x<5&&l.copyWithin(i+5,i+3,i+3+d),l[i++]=219,B.setUint32(i,d),i+=4),i+=d}else if(g==="number")if(u>>>0===u)u<32||u<128&&this.useRecords===!1||u<64&&!this.randomAccessStructure?l[i++]=u:u<256?(l[i++]=204,l[i++]=u):u<65536?(l[i++]=205,l[i++]=u>>8,l[i++]=u&255):(l[i++]=206,B.setUint32(i,u),i+=4);else if(u>>0===u)u>=-32?l[i++]=256+u:u>=-128?(l[i++]=208,l[i++]=u+256):u>=-32768?(l[i++]=209,B.setInt16(i,u),i+=2):(l[i++]=210,B.setInt32(i,u),i+=4);else{let a;if((a=this.useFloat32)>0&&u<4294967296&&u>=-2147483648){l[i++]=202,B.setFloat32(i,u);let x;if(a<4||(x=u*Ue[(l[i]&127)<<1|l[i+1]>>7])>>0===x){i+=4;return}else i--}l[i++]=203,B.setFloat64(i,u),i+=8}else if(g==="object"||g==="function")if(!u)l[i++]=192;else{if(c){let x=c.get(u);if(x){if(!x.id){let p=c.idsToInsert||(c.idsToInsert=[]);x.id=p.push(x)}l[i++]=214,l[i++]=112,B.setUint32(i,x.id),i+=4;return}else c.set(u,{offset:i-t})}let a=u.constructor;if(a===Object)se(u,!0);else if(a===Array)xe(u);else if(a===Map)if(this.mapAsEmptyObject)l[i++]=128;else{d=u.size,d<16?l[i++]=128|d:d<65536?(l[i++]=222,l[i++]=d>>8,l[i++]=d&255):(l[i++]=223,B.setUint32(i,d),i+=4);for(let[x,p]of u)I(x),I(p)}else{for(let x=0,p=pe.length;x<p;x++){let y=Ye[x];if(u instanceof y){let w=pe[x];if(w.write){w.type&&(l[i++]=212,l[i++]=w.type,l[i++]=0);let Z=w.write.call(this,u);Z===u?Array.isArray(u)?xe(u):se(u):I(Z);return}let k=l,U=B,V=i;l=null;let H;try{H=w.pack.call(this,u,Z=>(l=k,k=null,i+=Z,i>N&&K(i),{target:l,targetView:B,position:i-Z}),I)}finally{k&&(l=k,B=U,i=V,N=l.length-10)}H&&(H.length+i>N&&K(H.length+i),i=xt(H,l,i,w.type));return}}if(Array.isArray(u))xe(u);else{if(u.toJSON){const x=u.toJSON();if(x!==u)return I(x)}if(g==="function")return I(this.writeFunction&&this.writeFunction(u));se(u,!u.hasOwnProperty)}}}else if(g==="boolean")l[i++]=u?195:194;else if(g==="bigint"){if(u<BigInt(1)<<BigInt(63)&&u>=-(BigInt(1)<<BigInt(63)))l[i++]=211,B.setBigInt64(i,u);else if(u<BigInt(1)<<BigInt(64)&&u>0)l[i++]=207,B.setBigUint64(i,u);else if(this.largeBigIntToFloat)l[i++]=203,B.setFloat64(i,Number(u));else if(this.useBigIntExtension&&u<2n**1023n&&u>-(2n**1023n)){l[i++]=199,i++,l[i++]=66;let a=[],x;do{let p=u&0xffn;x=(p&0x80n)===(u<0n?0x80n:0n),a.push(p),u>>=8n}while(!((u===0n||u===-1n)&&x));l[i-2]=a.length;for(let p=a.length;p>0;)l[i++]=Number(a[--p]);return}else throw new RangeError(u+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension or set largeBigIntToFloat to convert to float-64");i+=8}else if(g==="undefined")this.encodeUndefinedAsNil?l[i++]=192:(l[i++]=212,l[i++]=0,l[i++]=0);else throw new Error("Unknown type: "+g)},ke=this.variableMapSize||this.coercibleKeyAsNumber?u=>{let g=Object.keys(u),d=g.length;d<16?l[i++]=128|d:d<65536?(l[i++]=222,l[i++]=d>>8,l[i++]=d&255):(l[i++]=223,B.setUint32(i,d),i+=4);let a;if(this.coercibleKeyAsNumber)for(let x=0;x<d;x++){a=g[x];let p=Number(a);I(isNaN(p)?a:p),I(u[a])}else for(let x=0;x<d;x++)I(a=g[x]),I(u[a])}:(u,g)=>{l[i++]=222;let d=i-t;i+=2;let a=0;for(let x in u)(g||u.hasOwnProperty(x))&&(I(x),I(u[x]),a++);l[d+++t]=a>>8,l[d+t]=a&255},Ee=this.useRecords===!1?ke:e.progressiveRecords&&!J?(u,g)=>{let d,a=s.transitions||(s.transitions=Object.create(null)),x=i++-t,p;for(let y in u)if(g||u.hasOwnProperty(y)){if(d=a[y],d)a=d;else{let w=Object.keys(u),k=a;a=s.transitions;let U=0;for(let V=0,H=w.length;V<H;V++){let Z=w[V];d=a[Z],d||(d=a[Z]=Object.create(null),U++),a=d}x+t+1==i?(i--,de(a,w,U)):Oe(a,w,x,U),p=!0,a=k[y]}I(u[y])}if(!p){let y=a[v];y?l[x+t]=y:Oe(a,Object.keys(u),x,0)}}:(u,g)=>{let d,a=s.transitions||(s.transitions=Object.create(null)),x=0;for(let y in u)(g||u.hasOwnProperty(y))&&(d=a[y],d||(d=a[y]=Object.create(null),x++),a=d);let p=a[v];p?p>=96&&J?(l[i++]=((p-=96)&31)+96,l[i++]=p>>5):l[i++]=p:de(a,a.__keys__||Object.keys(u),x);for(let y in u)(g||u.hasOwnProperty(y))&&I(u[y])},Ae=typeof this.useRecords=="function"&&this.useRecords,se=Ae?(u,g)=>{Ae(u)?Ee(u,g):ke(u,g)}:Ee,K=u=>{let g;if(u>16777216){if(u-t>De)throw new Error("Packed buffer would be larger than maximum buffer size");g=Math.min(De,Math.round(Math.max((u-t)*(u>67108864?1.25:2),4194304)/4096)*4096)}else g=(Math.max(u-t<<2,l.length-1)>>12)+1<<12;let d=new le(g);return B=d.dataView||(d.dataView=new DataView(d.buffer,0,g)),u=Math.min(u,l.length),l.copy?l.copy(d,0,t,u):d.set(l.slice(t,u)),i-=t,t=0,N=d.length-10,l=d},de=(u,g,d)=>{let a=s.nextId;a||(a=64),a<D&&this.shouldShareStructure&&!this.shouldShareStructure(g)?(a=s.nextOwnId,a<Y||(a=D),s.nextOwnId=a+1):(a>=Y&&(a=D),s.nextId=a+1);let x=g.highByte=a>=96&&J?a-96>>5:-1;u[v]=a,u.__keys__=g,s[a-64]=g,a<D?(g.isShared=!0,s.sharedLength=a-63,f=!0,x>=0?(l[i++]=(a&31)+96,l[i++]=x):l[i++]=a):(x>=0?(l[i++]=213,l[i++]=114,l[i++]=(a&31)+96,l[i++]=x):(l[i++]=212,l[i++]=114,l[i++]=a),d&&(oe+=ie*d),L.length>=C&&(L.shift()[v]=0),L.push(u),I(g))},Oe=(u,g,d,a)=>{let x=l,p=i,y=N,w=t;l=te,i=0,t=0,l||(te=l=new le(8192)),N=l.length-10,de(u,g,a),te=l;let k=i;if(l=x,i=p,N=y,t=w,k>1){let U=i+k-1;U>N&&K(U);let V=d+t;l.copyWithin(V+k,V+1,i),l.set(te.slice(0,k),V),i=U}else l[d+t]=te[0]},ve=(u,g)=>{let d=ct(u,l,t,i,s,K,(a,x,p)=>{if(p)return f=!0;i=x;let y=l;return I(a),Be(),y!==l?{position:i,targetView:B,target:l}:i},this);if(d===0)return se(u,!0);i=d}}useBuffer(e){l=e,B=new DataView(l.buffer,l.byteOffset,l.byteLength),i=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}Ye=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Fe];pe=[{pack(r,e,t){let f=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&f>=0&&f<4294967296){let{target:s,targetView:c,position:h}=e(6);s[h++]=214,s[h++]=255,c.setUint32(h,f)}else if(f>0&&f<4294967296){let{target:s,targetView:c,position:h}=e(10);s[h++]=215,s[h++]=255,c.setUint32(h,r.getMilliseconds()*4e6+(f/1e3/4294967296>>0)),c.setUint32(h+4,f)}else if(isNaN(f)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:s,targetView:c,position:h}=e(3);s[h++]=212,s[h++]=255,s[h++]=255}else{let{target:s,targetView:c,position:h}=e(15);s[h++]=199,s[h++]=12,s[h++]=255,c.setUint32(h,r.getMilliseconds()*1e6),c.setBigInt64(h+4,BigInt(Math.floor(f)))}}},{pack(r,e,t){if(this.setAsEmptyObject)return e(0),t({});let f=Array.from(r),{target:s,position:c}=e(this.moreTypes?3:0);this.moreTypes&&(s[c++]=212,s[c++]=115,s[c++]=0),t(f)}},{pack(r,e,t){let{target:f,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(f[s++]=212,f[s++]=101,f[s++]=0),t([r.name,r.message])}},{pack(r,e,t){let{target:f,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(f[s++]=212,f[s++]=120,f[s++]=0),t([r.source,r.flags])}},{pack(r,e){this.moreTypes?Le(r,16,e):Ve(ae?Buffer.from(r):new Uint8Array(r),e)}},{pack(r,e){let t=r.constructor;t!==He&&this.moreTypes?Le(r,Xe.indexOf(t.name),e):Ve(r,e)}},{pack(r,e){let{target:t,position:f}=e(1);t[f]=193}}];function Le(r,e,t,f){let s=r.byteLength;if(s+1<256){var{target:c,position:h}=t(4+s);c[h++]=199,c[h++]=s+1}else if(s+1<65536){var{target:c,position:h}=t(5+s);c[h++]=200,c[h++]=s+1>>8,c[h++]=s+1&255}else{var{target:c,position:h,targetView:S}=t(7+s);c[h++]=201,S.setUint32(h,s+1),h+=4}c[h++]=116,c[h++]=e,c.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),h)}function Ve(r,e){let t=r.byteLength;var f,s;if(t<256){var{target:f,position:s}=e(t+2);f[s++]=196,f[s++]=t}else if(t<65536){var{target:f,position:s}=e(t+3);f[s++]=197,f[s++]=t>>8,f[s++]=t&255}else{var{target:f,position:s,targetView:c}=e(t+5);f[s++]=198,c.setUint32(s,t),s+=4}f.set(r,s)}function xt(r,e,t,f){let s=r.length;switch(s){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:s<256?(e[t++]=199,e[t++]=s):s<65536?(e[t++]=200,e[t++]=s>>8,e[t++]=s&255):(e[t++]=201,e[t++]=s>>24,e[t++]=s>>16&255,e[t++]=s>>8&255,e[t++]=s&255)}return e[t++]=f,e.set(r,t),t+=s,t}function dt(r,e){let t,f=e.length*6,s=r.length-f;for(;t=e.pop();){let c=t.offset,h=t.id;r.copyWithin(c+f,c,s),f-=6;let S=c+f;r[S++]=214,r[S++]=105,r[S++]=h>>24,r[S++]=h>>16&255,r[S++]=h>>8&255,r[S++]=h&255,s=c}return r}function ze(r,e,t){if(A.length>0){B.setUint32(A.position+r,i+t-A.position-r),A.stringsPosition=i-r;let f=A;A=null,e(f[0]),e(f[1])}}function ht(r,e){return r.isCompatible=t=>{let f=!t||(e.lastNamedStructuresLength||0)===t.length;return f||e._mergeStructures(t),f},r}let We=new Qe({useRecords:!1});We.pack;We.pack;const ee=Qe,gt=512,yt=1024,wt=2048;async function mt(){await St(()=>({a:1e3,b:!0,c:{d:{e:{f:1e3}}},z:new Uint8Array([34,0,0,0,241,98,92,191,255,255,255,255,4,0,109,234,6,20,109,247,209,11,107,30,34,15,110,220,163,50,204,3,129,30,173,43,0,2,86,104,65,63,27,191,23,23])}))}class ge extends et{encode;decode;data;encodedData;constructor(e,t,f){super(),this.encode=t,this.decode=f,this.data=e,this.encodedData=t(e)}async encoding(){return this.encode(this.data)}async decoding(){return this.decode(this.encodedData)}}const St=async r=>{let e=new W,t=new ee;new W({structuredClone:!0}),new ee({structuredClone:!0}),new W({structuredClone:!0,useRecords:!0}),new ee({structuredClone:!0,useRecords:!0}),new W({structuredClone:!0,structures:[]}),new W({structuredClone:!0,structures:[],useRecords:!0}),new W({structures:[],useRecords:!0}),new ee({structuredClone:!0,structures:[]}),new ee({structuredClone:!0,structures:[],useRecords:!0}),new ee({structures:[],useRecords:!0}),new Array,await new ge(r(),JSON.stringify,JSON.parse).run({name:"JSON"}),await new ge(r(),e.encode.bind(e),e.decode.bind(e)).run({name:"CBOR"}),await new ge(r(),t.encode.bind(t),t.decode.bind(t)).run({name:"MSGPack"})};export{mt as m};
