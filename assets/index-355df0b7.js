import{E as W}from"./encode-6b53eb4b.js";import{B as et}from"./index-8321c0dd.js";var ye;try{ye=new TextDecoder}catch{}var x,z,n=0,B={},m,X,V=0,J=0,M,q,N=[],b,Ie={useRecords:!1,mapsAsObjects:!0};class Fe{}const Je=new Fe;Je.name="MessagePack 0xC1";var G=!1,$e=2,_e;try{new Function("")}catch{$e=1/0}class re{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(x)return Ge(()=>(Se(),this?this.unpack(e,t):re.prototype.unpack.call(Ie,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof t=="object"?(z=t.end||e.length,n=t.start||0):(n=0,z=t>-1?t:e.length),J=0,X=null,M=null,x=e;try{b=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(f){throw x=null,e instanceof Uint8Array?f:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof re){if(B=this,this.structures)return m=this.structures,fe(t);(!m||m.length>0)&&(m=[])}else B=Ie,(!m||m.length>0)&&(m=[]);return fe(t)}unpackMultiple(e,t){let f,s=0;try{G=!0;let c=e.length,d=this?this.unpack(e,c):ce.unpack(e,c);if(t){if(t(d,s,n)===!1)return;for(;n<c;)if(s=n,t(fe(),s,n)===!1)return}else{for(f=[d];n<c;)s=n,f.push(fe());return f}}catch(c){throw c.lastPosition=s,c.values=f,c}finally{G=!1,Se()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(f=>f.slice(0)));for(let f=0,s=e.length;f<s;f++){let c=e[f];c&&(c.isShared=!0,f>=32&&(c.highByte=f-32>>5))}e.sharedLength=e.length;for(let f in t||[])if(f>=0){let s=e[f],c=t[f];c&&(s&&((e.restoreStructures||(e.restoreStructures=[]))[f]=s),e[f]=c)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function fe(r){try{if(!B.trusted&&!G){let t=m.sharedLength||0;t<m.length&&(m.length=t)}let e;if(B.randomAccessStructure&&x[n]<64&&x[n]>=32&&_e?(e=_e(x,n,z,B),x=null,!(r&&r.lazy)&&e&&(e=e.toJSON()),n=z):e=_(),M&&(n=M.postBundlePosition,M=null),G&&(m.restoreStructures=null),n==z)m&&m.restoreStructures&&Te(),m=null,x=null,q&&(q=null);else{if(n>z)throw new Error("Unexpected end of MessagePack data");if(!G){let t;try{t=JSON.stringify(e,(f,s)=>typeof s=="bigint"?`${s}n`:s).slice(0,100)}catch(f){t="(JSON view not available "+f+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw m&&m.restoreStructures&&Te(),Se(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||n>z)&&(e.incomplete=!0),e}}function Te(){for(let r in m.restoreStructures)m[r]=m.restoreStructures[r];m.restoreStructures=null}function _(){let r=x[n++];if(r<160)if(r<128){if(r<64)return r;{let e=m[r&63]||B.getStructures&&qe()[r&63];return e?(e.read||(e.read=be(e,r&63)),e.read()):r}}else if(r<144)if(r-=128,B.mapsAsObjects){let e={};for(let t=0;t<r;t++){let f=Ze();f==="__proto__"&&(f="__proto_"),e[f]=_()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(_(),_());return e}else{r-=144;let e=new Array(r);for(let t=0;t<r;t++)e[t]=_();return B.freezeData?Object.freeze(e):e}else if(r<192){let e=r-160;if(J>=n)return X.slice(n-V,(n+=e)-V);if(J==0&&z<140){let t=e<16?me(e):Ke(e);if(t!=null)return t}return we(e)}else{let e;switch(r){case 192:return null;case 193:return M?(e=_(),e>0?M[1].slice(M.position1,M.position1+=e):M[0].slice(M.position0,M.position0-=e)):Je;case 194:return!1;case 195:return!0;case 196:if(e=x[n++],e===void 0)throw new Error("Unexpected end of buffer");return he(e);case 197:return e=b.getUint16(n),n+=2,he(e);case 198:return e=b.getUint32(n),n+=4,he(e);case 199:return Q(x[n++]);case 200:return e=b.getUint16(n),n+=2,Q(e);case 201:return e=b.getUint32(n),n+=4,Q(e);case 202:if(e=b.getFloat32(n),B.useFloat32>2){let t=Ue[(x[n]&127)<<1|x[n+1]>>7];return n+=4,(t*e+(e>0?.5:-.5)>>0)/t}return n+=4,e;case 203:return e=b.getFloat64(n),n+=8,e;case 204:return x[n++];case 205:return e=b.getUint16(n),n+=2,e;case 206:return e=b.getUint32(n),n+=4,e;case 207:return B.int64AsType==="number"?(e=b.getUint32(n)*4294967296,e+=b.getUint32(n+4)):B.int64AsType==="string"?e=b.getBigUint64(n).toString():B.int64AsType==="auto"?(e=b.getBigUint64(n),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=b.getBigUint64(n),n+=8,e;case 208:return b.getInt8(n++);case 209:return e=b.getInt16(n),n+=2,e;case 210:return e=b.getInt32(n),n+=4,e;case 211:return B.int64AsType==="number"?(e=b.getInt32(n)*4294967296,e+=b.getUint32(n+4)):B.int64AsType==="string"?e=b.getBigInt64(n).toString():B.int64AsType==="auto"?(e=b.getBigInt64(n),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=b.getBigInt64(n),n+=8,e;case 212:if(e=x[n++],e==114)return De(x[n++]&63);{let t=N[e];if(t)return t.read?(n++,t.read(_())):t.noBuffer?(n++,t()):t(x.subarray(n,++n));throw new Error("Unknown extension "+e)}case 213:return e=x[n],e==114?(n++,De(x[n++]&63,x[n++])):Q(2);case 214:return Q(4);case 215:return Q(8);case 216:return Q(16);case 217:return e=x[n++],J>=n?X.slice(n-V,(n+=e)-V):rt(e);case 218:return e=b.getUint16(n),n+=2,J>=n?X.slice(n-V,(n+=e)-V):nt(e);case 219:return e=b.getUint32(n),n+=4,J>=n?X.slice(n-V,(n+=e)-V):it(e);case 220:return e=b.getUint16(n),n+=2,Me(e);case 221:return e=b.getUint32(n),n+=4,Me(e);case 222:return e=b.getUint16(n),n+=2,Pe(e);case 223:return e=b.getUint32(n),n+=4,Pe(e);default:if(r>=224)return r-256;if(r===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+r)}}}const tt=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function be(r,e){function t(){if(t.count++>$e){let s=r.read=new Function("r","return function(){return "+(B.freezeData?"Object.freeze":"")+"({"+r.map(c=>c==="__proto__"?"__proto_:r()":tt.test(c)?c+":r()":"["+JSON.stringify(c)+"]:r()").join(",")+"})}")(_);return r.highByte===0&&(r.read=Re(e,r.read)),s()}let f={};for(let s=0,c=r.length;s<c;s++){let d=r[s];d==="__proto__"&&(d="__proto_"),f[d]=_()}return B.freezeData?Object.freeze(f):f}return t.count=0,r.highByte===0?Re(e,t):t}const Re=(r,e)=>function(){let t=x[n++];if(t===0)return e();let f=r<32?-(r+(t<<5)):r+(t<<5),s=m[f]||qe()[f];if(!s)throw new Error("Record id is not defined for "+f);return s.read||(s.read=be(s,r)),s.read()};function qe(){let r=Ge(()=>(x=null,B.getStructures()));return m=B._mergeStructures(r,m)}var we=ne,rt=ne,nt=ne,it=ne;function ne(r){let e;if(r<16&&(e=me(r)))return e;if(r>64&&ye)return ye.decode(x.subarray(n,n+=r));const t=n+r,f=[];for(e="";n<t;){const s=x[n++];if(!(s&128))f.push(s);else if((s&224)===192){const c=x[n++]&63;f.push((s&31)<<6|c)}else if((s&240)===224){const c=x[n++]&63,d=x[n++]&63;f.push((s&31)<<12|c<<6|d)}else if((s&248)===240){const c=x[n++]&63,d=x[n++]&63,w=x[n++]&63;let A=(s&7)<<18|c<<12|d<<6|w;A>65535&&(A-=65536,f.push(A>>>10&1023|55296),A=56320|A&1023),f.push(A)}else f.push(s);f.length>=4096&&(e+=R.apply(String,f),f.length=0)}return f.length>0&&(e+=R.apply(String,f)),e}function Me(r){let e=new Array(r);for(let t=0;t<r;t++)e[t]=_();return B.freezeData?Object.freeze(e):e}function Pe(r){if(B.mapsAsObjects){let e={};for(let t=0;t<r;t++){let f=Ze();f==="__proto__"&&(f="__proto_"),e[f]=_()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(_(),_());return e}}var R=String.fromCharCode;function Ke(r){let e=n,t=new Array(r);for(let f=0;f<r;f++){const s=x[n++];if((s&128)>0){n=e;return}t[f]=s}return R.apply(String,t)}function me(r){if(r<4)if(r<2){if(r===0)return"";{let e=x[n++];if((e&128)>1){n-=1;return}return R(e)}}else{let e=x[n++],t=x[n++];if((e&128)>0||(t&128)>0){n-=2;return}if(r<3)return R(e,t);let f=x[n++];if((f&128)>0){n-=3;return}return R(e,t,f)}else{let e=x[n++],t=x[n++],f=x[n++],s=x[n++];if((e&128)>0||(t&128)>0||(f&128)>0||(s&128)>0){n-=4;return}if(r<6){if(r===4)return R(e,t,f,s);{let c=x[n++];if((c&128)>0){n-=5;return}return R(e,t,f,s,c)}}else if(r<8){let c=x[n++],d=x[n++];if((c&128)>0||(d&128)>0){n-=6;return}if(r<7)return R(e,t,f,s,c,d);let w=x[n++];if((w&128)>0){n-=7;return}return R(e,t,f,s,c,d,w)}else{let c=x[n++],d=x[n++],w=x[n++],A=x[n++];if((c&128)>0||(d&128)>0||(w&128)>0||(A&128)>0){n-=8;return}if(r<10){if(r===8)return R(e,t,f,s,c,d,w,A);{let P=x[n++];if((P&128)>0){n-=9;return}return R(e,t,f,s,c,d,w,A,P)}}else if(r<12){let P=x[n++],T=x[n++];if((P&128)>0||(T&128)>0){n-=10;return}if(r<11)return R(e,t,f,s,c,d,w,A,P,T);let C=x[n++];if((C&128)>0){n-=11;return}return R(e,t,f,s,c,d,w,A,P,T,C)}else{let P=x[n++],T=x[n++],C=x[n++],F=x[n++];if((P&128)>0||(T&128)>0||(C&128)>0||(F&128)>0){n-=12;return}if(r<14){if(r===12)return R(e,t,f,s,c,d,w,A,P,T,C,F);{let D=x[n++];if((D&128)>0){n-=13;return}return R(e,t,f,s,c,d,w,A,P,T,C,F,D)}}else{let D=x[n++],Y=x[n++];if((D&128)>0||(Y&128)>0){n-=14;return}if(r<15)return R(e,t,f,s,c,d,w,A,P,T,C,F,D,Y);let L=x[n++];if((L&128)>0){n-=15;return}return R(e,t,f,s,c,d,w,A,P,T,C,F,D,Y,L)}}}}}function Ce(){let r=x[n++],e;if(r<192)e=r-160;else switch(r){case 217:e=x[n++];break;case 218:e=b.getUint16(n),n+=2;break;case 219:e=b.getUint32(n),n+=4;break;default:throw new Error("Expected string")}return ne(e)}function he(r){return B.copyBuffers?Uint8Array.prototype.slice.call(x,n,n+=r):x.subarray(n,n+=r)}function Q(r){let e=x[n++];if(N[e]){let t;return N[e](x.subarray(n,t=n+=r),f=>{n=f;try{return _()}finally{n=t}})}else throw new Error("Unknown extension type "+e)}var je=new Array(4096);function Ze(){let r=x[n++];if(r>=160&&r<192){if(r=r-160,J>=n)return X.slice(n-V,(n+=r)-V);if(!(J==0&&z<180))return we(r)}else return n--,_().toString();let e=(r<<5^(r>1?b.getUint16(n):r>0?x[n]:0))&4095,t=je[e],f=n,s=n+r-3,c,d=0;if(t&&t.bytes==r){for(;f<s;){if(c=b.getUint32(f),c!=t[d++]){f=1879048192;break}f+=4}for(s+=3;f<s;)if(c=x[f++],c!=t[d++]){f=1879048192;break}if(f===s)return n=f,t.string;s-=3,f=n}for(t=[],je[e]=t,t.bytes=r;f<s;)c=b.getUint32(f),t.push(c),f+=4;for(s+=3;f<s;)c=x[f++],t.push(c);let w=r<16?me(r):Ke(r);return w!=null?t.string=w:t.string=we(r)}const De=(r,e)=>{let t=_().map(c=>c.toString()),f=r;e!==void 0&&(r=r<32?-((e<<5)+r):(e<<5)+r,t.highByte=e);let s=m[r];return s&&(s.isShared||G)&&((m.restoreStructures||(m.restoreStructures=[]))[r]=s),m[r]=t,t.read=be(t,f),t.read()};N[0]=()=>{};N[0].noBuffer=!0;let st={Error,TypeError,ReferenceError};N[101]=()=>{let r=_();return(st[r[0]]||Error)(r[1])};N[105]=r=>{let e=b.getUint32(n-4);q||(q=new Map);let t=x[n],f;t>=144&&t<160||t==220||t==221?f=[]:f={};let s={target:f};q.set(e,s);let c=_();return s.used?Object.assign(f,c):(s.target=c,c)};N[112]=r=>{let e=b.getUint32(n-4),t=q.get(e);return t.used=!0,t.target};N[115]=()=>new Set(_());const Xe=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array");let ft=typeof globalThis=="object"?globalThis:window;N[116]=r=>{let e=r[0],t=Xe[e];if(!t)throw new Error("Could not find typed array for code "+e);return new ft[t](Uint8Array.prototype.slice.call(r,1).buffer)};N[120]=()=>{let r=_();return new RegExp(r[0],r[1])};const lt=[];N[98]=r=>{let e=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],t=n;return n+=e-r.length,M=lt,M=[Ce(),Ce()],M.position0=0,M.position1=0,M.postBundlePosition=n,n=t,_()};N[255]=r=>r.length==4?new Date((r[0]*16777216+(r[1]<<16)+(r[2]<<8)+r[3])*1e3):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+((r[3]&3)*4294967296+r[4]*16777216+(r[5]<<16)+(r[6]<<8)+r[7])*1e3):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+((r[4]&128?-281474976710656:0)+r[6]*1099511627776+r[7]*4294967296+r[8]*16777216+(r[9]<<16)+(r[10]<<8)+r[11])*1e3):new Date("invalid");function Ge(r){let e=z,t=n,f=V,s=J,c=X,d=q,w=M,A=new Uint8Array(x.slice(0,z)),P=m,T=m.slice(0,m.length),C=B,F=G,D=r();return z=e,n=t,V=f,J=s,X=c,q=d,M=w,x=A,G=F,m=P,m.splice(0,m.length,...T),B=C,b=new DataView(x.buffer,x.byteOffset,x.byteLength),D}function Se(){x=null,q=null,m=null}const Ue=new Array(147);for(let r=0;r<256;r++)Ue[r]=+("1e"+Math.floor(45.15-r*.30103));var ce=new re({useRecords:!1});ce.unpack;ce.unpackMultiple;ce.unpack;let ut=new Float32Array(1);new Uint8Array(ut.buffer,0,4);let ue;try{ue=new TextEncoder}catch{}let pe,Ye;const ae=typeof Buffer<"u",le=ae?function(r){return Buffer.allocUnsafeSlow(r)}:Uint8Array,He=ae?Buffer:Uint8Array,Ne=ae?4294967296:2144337920;let l,te,k,i=0,j,E=null,ct;const at=21760,ot=/[\u0080-\uFFFF]/,v=Symbol("record-id");class Qe extends re{constructor(e){super(e),this.offset=0;let t,f,s,c,d=He.prototype.utf8Write?function(u,g){return l.utf8Write(u,g,4294967295)}:ue&&ue.encodeInto?function(u,g){return ue.encodeInto(u,l.subarray(g)).written}:!1,w=this;e||(e={});let A=e&&e.sequential,P=e.structures||e.saveStructures,T=e.maxSharedStructures;if(T==null&&(T=P?32:0),T>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let C=e.maxOwnStructures;C==null&&(C=P?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let F=T>32||C+T>64,D=T+64,Y=T+C+64;if(Y>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let L=[],oe=0,ie=0;this.pack=this.encode=function(u,g){if(l||(l=new le(8192),k=l.dataView||(l.dataView=new DataView(l.buffer,0,8192)),i=0),j=l.length-10,j-i<2048?(l=new le(l.length),k=l.dataView||(l.dataView=new DataView(l.buffer,0,l.length)),j=l.length-10,i=0):i=i+7&2147483640,t=i,g&wt&&(i+=g&255),c=w.structuredClone?new Map:null,w.bundleStrings&&typeof u!="string"?(E=[],E.size=1/0):E=null,s=w.structures,s){s.uninitialized&&(s=w._mergeStructures(w.getStructures()));let a=s.sharedLength||0;if(a>T)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+s.sharedLength);if(!s.transitions){s.transitions=Object.create(null);for(let o=0;o<a;o++){let h=s[o];if(!h)continue;let S,p=s.transitions;for(let y=0,I=h.length;y<I;y++){let U=h[y];S=p[U],S||(S=p[U]=Object.create(null)),p=S}p[v]=o+64}this.lastNamedStructuresLength=a}A||(s.nextId=a+64)}f&&(f=!1);try{w.randomAccessStructure&&u&&u.constructor&&u.constructor===Object?ve(u):O(u);let a=E;if(E&&ze(t,O,0),c&&c.idsToInsert){let o=c.idsToInsert.sort((y,I)=>y.offset>I.offset?1:-1),h=o.length,S=-1;for(;a&&h>0;){let y=o[--h].offset+t;y<a.stringsPosition+t&&S===-1&&(S=0),y>a.position+t?S>=0&&(S+=6):(S>=0&&(k.setUint32(a.position+t,k.getUint32(a.position+t)+S),S=-1),a=a.previous,h++)}S>=0&&a&&k.setUint32(a.position+t,k.getUint32(a.position+t)+S),i+=o.length*6,i>j&&K(i),w.offset=i;let p=dt(l.subarray(t,i),o);return c=null,p}return w.offset=i,g&gt?(l.start=t,l.end=i,l):l.subarray(t,i)}finally{if(s&&(ke(),f&&w.saveStructures)){let a=s.sharedLength||0,o=l.subarray(t,i),h=ht(s,w);return w.saveStructures(h,h.isCompatible)===!1?w.pack(u,g):(w.lastNamedStructuresLength=a,o)}g&yt&&(i=t)}};const ke=()=>{ie<10&&ie++;let u=s.sharedLength||0;if(s.length>u&&!A&&(s.length=u),oe>1e4)s.transitions=null,ie=0,oe=0,L.length>0&&(L=[]);else if(L.length>0&&!A){for(let g=0,a=L.length;g<a;g++)L[g][v]=0;L=[]}},xe=u=>{var g=u.length;g<16?l[i++]=144|g:g<65536?(l[i++]=220,l[i++]=g>>8,l[i++]=g&255):(l[i++]=221,k.setUint32(i,g),i+=4);for(let a=0;a<g;a++)O(u[a])},O=u=>{i>j&&(l=K(i));var g=typeof u,a;if(g==="string"){let o=u.length;if(E&&o>=4&&o<4096){if((E.size+=o)>at){let y,I=(E[0]?E[0].length*3+E[1].length:0)+10;i+I>j&&(l=K(i+I));let U;E.position?(U=E,l[i]=200,i+=3,l[i++]=98,y=i-t,i+=4,ze(t,O,0),k.setUint16(y+t-3,i-t-y)):(l[i++]=214,l[i++]=98,y=i-t,i+=4),E=["",""],E.previous=U,E.size=0,E.position=y}let p=ot.test(u);E[p?0:1]+=u,l[i++]=193,O(p?-o:o);return}let h;o<32?h=1:o<256?h=2:o<65536?h=3:h=5;let S=o*3;if(i+S>j&&(l=K(i+S)),o<64||!d){let p,y,I,U=i+h;for(p=0;p<o;p++)y=u.charCodeAt(p),y<128?l[U++]=y:y<2048?(l[U++]=y>>6|192,l[U++]=y&63|128):(y&64512)===55296&&((I=u.charCodeAt(p+1))&64512)===56320?(y=65536+((y&1023)<<10)+(I&1023),p++,l[U++]=y>>18|240,l[U++]=y>>12&63|128,l[U++]=y>>6&63|128,l[U++]=y&63|128):(l[U++]=y>>12|224,l[U++]=y>>6&63|128,l[U++]=y&63|128);a=U-i-h}else a=d(u,i+h);a<32?l[i++]=160|a:a<256?(h<2&&l.copyWithin(i+2,i+1,i+1+a),l[i++]=217,l[i++]=a):a<65536?(h<3&&l.copyWithin(i+3,i+2,i+2+a),l[i++]=218,l[i++]=a>>8,l[i++]=a&255):(h<5&&l.copyWithin(i+5,i+3,i+3+a),l[i++]=219,k.setUint32(i,a),i+=4),i+=a}else if(g==="number")if(u>>>0===u)u<32||u<128&&this.useRecords===!1||u<64&&!this.randomAccessStructure?l[i++]=u:u<256?(l[i++]=204,l[i++]=u):u<65536?(l[i++]=205,l[i++]=u>>8,l[i++]=u&255):(l[i++]=206,k.setUint32(i,u),i+=4);else if(u>>0===u)u>=-32?l[i++]=256+u:u>=-128?(l[i++]=208,l[i++]=u+256):u>=-32768?(l[i++]=209,k.setInt16(i,u),i+=2):(l[i++]=210,k.setInt32(i,u),i+=4);else{let o;if((o=this.useFloat32)>0&&u<4294967296&&u>=-2147483648){l[i++]=202,k.setFloat32(i,u);let h;if(o<4||(h=u*Ue[(l[i]&127)<<1|l[i+1]>>7])>>0===h){i+=4;return}else i--}l[i++]=203,k.setFloat64(i,u),i+=8}else if(g==="object"||g==="function")if(!u)l[i++]=192;else{if(c){let h=c.get(u);if(h){if(!h.id){let S=c.idsToInsert||(c.idsToInsert=[]);h.id=S.push(h)}l[i++]=214,l[i++]=112,k.setUint32(i,h.id),i+=4;return}else c.set(u,{offset:i-t})}let o=u.constructor;if(o===Object)se(u,!0);else if(o===Array)xe(u);else if(o===Map)if(this.mapAsEmptyObject)l[i++]=128;else{a=u.size,a<16?l[i++]=128|a:a<65536?(l[i++]=222,l[i++]=a>>8,l[i++]=a&255):(l[i++]=223,k.setUint32(i,a),i+=4);for(let[h,S]of u)O(h),O(S)}else{for(let h=0,S=pe.length;h<S;h++){let p=Ye[h];if(u instanceof p){let y=pe[h];if(y.write){y.type&&(l[i++]=212,l[i++]=y.type,l[i++]=0);let Z=y.write.call(this,u);Z===u?Array.isArray(u)?xe(u):se(u):O(Z);return}let I=l,U=k,$=i;l=null;let H;try{H=y.pack.call(this,u,Z=>(l=I,I=null,i+=Z,i>j&&K(i),{target:l,targetView:k,position:i-Z}),O)}finally{I&&(l=I,k=U,i=$,j=l.length-10)}H&&(H.length+i>j&&K(H.length+i),i=xt(H,l,i,y.type));return}}if(Array.isArray(u))xe(u);else{if(u.toJSON){const h=u.toJSON();if(h!==u)return O(h)}if(g==="function")return O(this.writeFunction&&this.writeFunction(u));se(u,!u.hasOwnProperty)}}}else if(g==="boolean")l[i++]=u?195:194;else if(g==="bigint"){if(u<BigInt(1)<<BigInt(63)&&u>=-(BigInt(1)<<BigInt(63)))l[i++]=211,k.setBigInt64(i,u);else if(u<BigInt(1)<<BigInt(64)&&u>0)l[i++]=207,k.setBigUint64(i,u);else if(this.largeBigIntToFloat)l[i++]=203,k.setFloat64(i,Number(u));else throw new RangeError(u+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");i+=8}else if(g==="undefined")this.encodeUndefinedAsNil?l[i++]=192:(l[i++]=212,l[i++]=0,l[i++]=0);else throw new Error("Unknown type: "+g)},Be=this.variableMapSize||this.coercibleKeyAsNumber?u=>{let g=Object.keys(u),a=g.length;a<16?l[i++]=128|a:a<65536?(l[i++]=222,l[i++]=a>>8,l[i++]=a&255):(l[i++]=223,k.setUint32(i,a),i+=4);let o;if(this.coercibleKeyAsNumber)for(let h=0;h<a;h++){o=g[h];let S=Number(o);O(isNaN(S)?o:S),O(u[o])}else for(let h=0;h<a;h++)O(o=g[h]),O(u[o])}:(u,g)=>{l[i++]=222;let a=i-t;i+=2;let o=0;for(let h in u)(g||u.hasOwnProperty(h))&&(O(h),O(u[h]),o++);l[a+++t]=o>>8,l[a+t]=o&255},Ee=this.useRecords===!1?Be:e.progressiveRecords&&!F?(u,g)=>{let a,o=s.transitions||(s.transitions=Object.create(null)),h=i++-t,S;for(let p in u)if(g||u.hasOwnProperty(p)){if(a=o[p],a)o=a;else{let y=Object.keys(u),I=o;o=s.transitions;let U=0;for(let $=0,H=y.length;$<H;$++){let Z=y[$];a=o[Z],a||(a=o[Z]=Object.create(null),U++),o=a}h+t+1==i?(i--,de(o,y,U)):Oe(o,y,h,U),S=!0,o=I[p]}O(u[p])}if(!S){let p=o[v];p?l[h+t]=p:Oe(o,Object.keys(u),h,0)}}:(u,g)=>{let a,o=s.transitions||(s.transitions=Object.create(null)),h=0;for(let p in u)(g||u.hasOwnProperty(p))&&(a=o[p],a||(a=o[p]=Object.create(null),h++),o=a);let S=o[v];S?S>=96&&F?(l[i++]=((S-=96)&31)+96,l[i++]=S>>5):l[i++]=S:de(o,o.__keys__||Object.keys(u),h);for(let p in u)(g||u.hasOwnProperty(p))&&O(u[p])},Ae=typeof this.useRecords=="function"&&this.useRecords,se=Ae?(u,g)=>{Ae(u)?Ee(u,g):Be(u,g)}:Ee,K=u=>{let g;if(u>16777216){if(u-t>Ne)throw new Error("Packed buffer would be larger than maximum buffer size");g=Math.min(Ne,Math.round(Math.max((u-t)*(u>67108864?1.25:2),4194304)/4096)*4096)}else g=(Math.max(u-t<<2,l.length-1)>>12)+1<<12;let a=new le(g);return k=a.dataView||(a.dataView=new DataView(a.buffer,0,g)),u=Math.min(u,l.length),l.copy?l.copy(a,0,t,u):a.set(l.slice(t,u)),i-=t,t=0,j=a.length-10,l=a},de=(u,g,a)=>{let o=s.nextId;o||(o=64),o<D&&this.shouldShareStructure&&!this.shouldShareStructure(g)?(o=s.nextOwnId,o<Y||(o=D),s.nextOwnId=o+1):(o>=Y&&(o=D),s.nextId=o+1);let h=g.highByte=o>=96&&F?o-96>>5:-1;u[v]=o,u.__keys__=g,s[o-64]=g,o<D?(g.isShared=!0,s.sharedLength=o-63,f=!0,h>=0?(l[i++]=(o&31)+96,l[i++]=h):l[i++]=o):(h>=0?(l[i++]=213,l[i++]=114,l[i++]=(o&31)+96,l[i++]=h):(l[i++]=212,l[i++]=114,l[i++]=o),a&&(oe+=ie*a),L.length>=C&&(L.shift()[v]=0),L.push(u),O(g))},Oe=(u,g,a,o)=>{let h=l,S=i,p=j,y=t;l=te,i=0,t=0,l||(te=l=new le(8192)),j=l.length-10,de(u,g,o),te=l;let I=i;if(l=h,i=S,j=p,t=y,I>1){let U=i+I-1;U>j&&K(U);let $=a+t;l.copyWithin($+I,$+1,i),l.set(te.slice(0,I),$),i=U}else l[a+t]=te[0]},ve=(u,g)=>{let a=ct(u,l,t,i,s,K,(o,h,S)=>{if(S)return f=!0;i=h;let p=l;return O(o),ke(),p!==l?{position:i,targetView:k,target:l}:i},this);if(a===0)return se(u,!0);i=a}}useBuffer(e){l=e,k=new DataView(l.buffer,l.byteOffset,l.byteLength),i=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}Ye=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Fe];pe=[{pack(r,e,t){let f=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&f>=0&&f<4294967296){let{target:s,targetView:c,position:d}=e(6);s[d++]=214,s[d++]=255,c.setUint32(d,f)}else if(f>0&&f<4294967296){let{target:s,targetView:c,position:d}=e(10);s[d++]=215,s[d++]=255,c.setUint32(d,r.getMilliseconds()*4e6+(f/1e3/4294967296>>0)),c.setUint32(d+4,f)}else if(isNaN(f)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:s,targetView:c,position:d}=e(3);s[d++]=212,s[d++]=255,s[d++]=255}else{let{target:s,targetView:c,position:d}=e(15);s[d++]=199,s[d++]=12,s[d++]=255,c.setUint32(d,r.getMilliseconds()*1e6),c.setBigInt64(d+4,BigInt(Math.floor(f)))}}},{pack(r,e,t){if(this.setAsEmptyObject)return e(0),t({});let f=Array.from(r),{target:s,position:c}=e(this.moreTypes?3:0);this.moreTypes&&(s[c++]=212,s[c++]=115,s[c++]=0),t(f)}},{pack(r,e,t){let{target:f,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(f[s++]=212,f[s++]=101,f[s++]=0),t([r.name,r.message])}},{pack(r,e,t){let{target:f,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(f[s++]=212,f[s++]=120,f[s++]=0),t([r.source,r.flags])}},{pack(r,e){this.moreTypes?Le(r,16,e):Ve(ae?Buffer.from(r):new Uint8Array(r),e)}},{pack(r,e){let t=r.constructor;t!==He&&this.moreTypes?Le(r,Xe.indexOf(t.name),e):Ve(r,e)}},{pack(r,e){let{target:t,position:f}=e(1);t[f]=193}}];function Le(r,e,t,f){let s=r.byteLength;if(s+1<256){var{target:c,position:d}=t(4+s);c[d++]=199,c[d++]=s+1}else if(s+1<65536){var{target:c,position:d}=t(5+s);c[d++]=200,c[d++]=s+1>>8,c[d++]=s+1&255}else{var{target:c,position:d,targetView:w}=t(7+s);c[d++]=201,w.setUint32(d,s+1),d+=4}c[d++]=116,c[d++]=e,c.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),d)}function Ve(r,e){let t=r.byteLength;var f,s;if(t<256){var{target:f,position:s}=e(t+2);f[s++]=196,f[s++]=t}else if(t<65536){var{target:f,position:s}=e(t+3);f[s++]=197,f[s++]=t>>8,f[s++]=t&255}else{var{target:f,position:s,targetView:c}=e(t+5);f[s++]=198,c.setUint32(s,t),s+=4}f.set(r,s)}function xt(r,e,t,f){let s=r.length;switch(s){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:s<256?(e[t++]=199,e[t++]=s):s<65536?(e[t++]=200,e[t++]=s>>8,e[t++]=s&255):(e[t++]=201,e[t++]=s>>24,e[t++]=s>>16&255,e[t++]=s>>8&255,e[t++]=s&255)}return e[t++]=f,e.set(r,t),t+=s,t}function dt(r,e){let t,f=e.length*6,s=r.length-f;for(;t=e.pop();){let c=t.offset,d=t.id;r.copyWithin(c+f,c,s),f-=6;let w=c+f;r[w++]=214,r[w++]=105,r[w++]=d>>24,r[w++]=d>>16&255,r[w++]=d>>8&255,r[w++]=d&255,s=c}return r}function ze(r,e,t){if(E.length>0){k.setUint32(E.position+r,i+t-E.position-r),E.stringsPosition=i-r;let f=E;E=null,e(f[0]),e(f[1])}}function ht(r,e){return r.isCompatible=t=>{let f=!t||(e.lastNamedStructuresLength||0)===t.length;return f||e._mergeStructures(t),f},r}let We=new Qe({useRecords:!1});We.pack;We.pack;const ee=Qe,gt=512,yt=1024,wt=2048;async function mt(){await St(()=>({a:1e3,b:!0,c:{d:{e:{f:1e3}}},z:new Uint8Array([34,0,0,0,241,98,92,191,255,255,255,255,4,0,109,234,6,20,109,247,209,11,107,30,34,15,110,220,163,50,204,3,129,30,173,43,0,2,86,104,65,63,27,191,23,23])}))}class ge extends et{encode;decode;data;encodedData;constructor(e,t,f){super(),this.encode=t,this.decode=f,this.data=e,this.encodedData=t(e)}async encoding(){return this.encode(this.data)}async decoding(){return this.decode(this.encodedData)}}const St=async r=>{let e=new W,t=new ee;new W({structuredClone:!0}),new ee({structuredClone:!0}),new W({structuredClone:!0,useRecords:!0}),new ee({structuredClone:!0,useRecords:!0}),new W({structuredClone:!0,structures:[]}),new W({structuredClone:!0,structures:[],useRecords:!0}),new W({structures:[],useRecords:!0}),new ee({structuredClone:!0,structures:[]}),new ee({structuredClone:!0,structures:[],useRecords:!0}),new ee({structures:[],useRecords:!0}),new Array,await new ge(r(),JSON.stringify,JSON.parse).run({name:"JSON"}),await new ge(r(),e.encode.bind(e),e.decode.bind(e)).run({name:"CBOR"}),await new ge(r(),t.encode.bind(t),t.decode.bind(t)).run({name:"MSGPack"})};export{mt as m};
