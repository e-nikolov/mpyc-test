var qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var He={exports:{}},$=typeof Reflect=="object"?Reflect:null,_t=$&&typeof $.apply=="function"?$.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},fe;$&&typeof $.ownKeys=="function"?fe=$.ownKeys:Object.getOwnPropertySymbols?fe=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:fe=function(e){return Object.getOwnPropertyNames(e)};function Ti(n){console&&console.warn&&console.warn(n)}var It=Number.isNaN||function(e){return e!==e};function h(){h.init.call(this)}He.exports=h;He.exports.once=Ai;h.EventEmitter=h;h.prototype._events=void 0;h.prototype._eventsCount=0;h.prototype._maxListeners=void 0;var pt=10;function me(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return pt},set:function(n){if(typeof n!="number"||n<0||It(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");pt=n}});h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};h.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||It(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Nt(n){return n._maxListeners===void 0?h.defaultMaxListeners:n._maxListeners}h.prototype.getMaxListeners=function(){return Nt(this)};h.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var r=e==="error",c=this._events;if(c!==void 0)r=r&&c.error===void 0;else if(!r)return!1;if(r){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var v=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw v.context=u,v}var N=c[e];if(N===void 0)return!1;if(typeof N=="function")_t(N,this,t);else for(var U=N.length,pe=kt(N,U),s=0;s<U;++s)_t(pe[s],this,t);return!0};function Ct(n,e,t,s){var r,c,u;if(me(t),c=n._events,c===void 0?(c=n._events=Object.create(null),n._eventsCount=0):(c.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),c=n._events),u=c[e]),u===void 0)u=c[e]=t,++n._eventsCount;else if(typeof u=="function"?u=c[e]=s?[t,u]:[u,t]:s?u.unshift(t):u.push(t),r=Nt(n),r>0&&u.length>r&&!u.warned){u.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=n,v.type=e,v.count=u.length,Ti(v)}return n}h.prototype.addListener=function(e,t){return Ct(this,e,t,!1)};h.prototype.on=h.prototype.addListener;h.prototype.prependListener=function(e,t){return Ct(this,e,t,!0)};function Ei(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Pt(n,e,t){var s={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},r=Ei.bind(s);return r.listener=t,s.wrapFn=r,r}h.prototype.once=function(e,t){return me(t),this.on(e,Pt(this,e,t)),this};h.prototype.prependOnceListener=function(e,t){return me(t),this.prependListener(e,Pt(this,e,t)),this};h.prototype.removeListener=function(e,t){var s,r,c,u,v;if(me(t),r=this._events,r===void 0)return this;if(s=r[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(c=-1,u=s.length-1;u>=0;u--)if(s[u]===t||s[u].listener===t){v=s[u].listener,c=u;break}if(c<0)return this;c===0?s.shift():vi(s,c),s.length===1&&(r[e]=s[0]),r.removeListener!==void 0&&this.emit("removeListener",e,v||t)}return this};h.prototype.off=h.prototype.removeListener;h.prototype.removeAllListeners=function(e){var t,s,r;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var c=Object.keys(s),u;for(r=0;r<c.length;++r)u=c[r],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function Mt(n,e,t){var s=n._events;if(s===void 0)return[];var r=s[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?Ri(r):kt(r,r.length)}h.prototype.listeners=function(e){return Mt(this,e,!0)};h.prototype.rawListeners=function(e){return Mt(this,e,!1)};h.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):xt.call(n,e)};h.prototype.listenerCount=xt;function xt(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}h.prototype.eventNames=function(){return this._eventsCount>0?fe(this._events):[]};function kt(n,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=n[s];return t}function vi(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Ri(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Ai(n,e){return new Promise(function(t,s){function r(u){n.removeListener(e,c),s(u)}function c(){typeof n.removeListener=="function"&&n.removeListener("error",r),t([].slice.call(arguments))}Ut(n,e,c,{once:!0}),e!=="error"&&yi(n,r,{once:!0})})}function yi(n,e,t){typeof n.on=="function"&&Ut(n,"error",e,t)}function Ut(n,e,t,s){if(typeof n.on=="function")s.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function r(c){s.once&&n.removeEventListener(e,r),t(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Li=He.exports,bi=function(n){if(typeof n.create!="function")throw new TypeError("factory.create must be a function");if(typeof n.destroy!="function")throw new TypeError("factory.destroy must be a function");if(typeof n.validate<"u"&&typeof n.validate!="function")throw new TypeError("factory.validate must be a function")};let Oi=class{constructor(){this.fifo=!0,this.priorityRange=1,this.testOnBorrow=!1,this.testOnReturn=!1,this.autostart=!0,this.evictionRunIntervalMillis=0,this.numTestsPerEvictionRun=3,this.softIdleTimeoutMillis=-1,this.idleTimeoutMillis=3e4,this.acquireTimeoutMillis=null,this.destroyTimeoutMillis=null,this.maxWaitingClients=null,this.min=null,this.max=null,this.Promise=Promise}};var wi=Oi;const Di=wi;let Si=class{constructor(e){const t=new Di;e=e||{},this.fifo=typeof e.fifo=="boolean"?e.fifo:t.fifo,this.priorityRange=e.priorityRange||t.priorityRange,this.testOnBorrow=typeof e.testOnBorrow=="boolean"?e.testOnBorrow:t.testOnBorrow,this.testOnReturn=typeof e.testOnReturn=="boolean"?e.testOnReturn:t.testOnReturn,this.autostart=typeof e.autostart=="boolean"?e.autostart:t.autostart,e.acquireTimeoutMillis&&(this.acquireTimeoutMillis=parseInt(e.acquireTimeoutMillis,10)),e.destroyTimeoutMillis&&(this.destroyTimeoutMillis=parseInt(e.destroyTimeoutMillis,10)),e.maxWaitingClients!==void 0&&(this.maxWaitingClients=parseInt(e.maxWaitingClients,10)),this.max=parseInt(e.max,10),this.min=parseInt(e.min,10),this.max=Math.max(isNaN(this.max)?1:this.max,1),this.min=Math.min(isNaN(this.min)?0:this.min,this.max),this.evictionRunIntervalMillis=e.evictionRunIntervalMillis||t.evictionRunIntervalMillis,this.numTestsPerEvictionRun=e.numTestsPerEvictionRun||t.numTestsPerEvictionRun,this.softIdleTimeoutMillis=e.softIdleTimeoutMillis||t.softIdleTimeoutMillis,this.idleTimeoutMillis=e.idleTimeoutMillis||t.idleTimeoutMillis,this.Promise=e.Promise!=null?e.Promise:t.Promise}};var Ii=Si;let de=class q{constructor(e){this._state=q.PENDING,this._resolve=void 0,this._reject=void 0,this._promise=new e((t,s)=>{this._resolve=t,this._reject=s})}get state(){return this._state}get promise(){return this._promise}reject(e){this._state===q.PENDING&&(this._state=q.REJECTED,this._reject(e))}resolve(e){this._state===q.PENDING&&(this._state=q.FULFILLED,this._resolve(e))}};de.PENDING="PENDING";de.FULFILLED="FULFILLED";de.REJECTED="REJECTED";var We=de;class Ni extends Error{constructor(e){super(e),this.name=this.constructor.name,this.message=e,typeof Error.captureStackTrace=="function"?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}}class Ci extends Ni{constructor(e){super(e)}}var Pi={TimeoutError:Ci};const Mi=We,xi=Pi;function ki(n,e){return function(){return n.apply(e,arguments)}}let Ui=class Ft extends Mi{constructor(e,t){super(t),this._creationTimestamp=Date.now(),this._timeout=null,e!==void 0&&this.setTimeout(e)}setTimeout(e){if(this._state!==Ft.PENDING)return;const t=parseInt(e,10);if(isNaN(t)||t<=0)throw new Error("delay must be a positive int");const s=Date.now()-this._creationTimestamp;this._timeout&&this.removeTimeout(),this._timeout=setTimeout(ki(this._fireTimeout,this),Math.max(t-s,0))}removeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=null}_fireTimeout(){this.reject(new xi.TimeoutError("ResourceRequest timed out"))}reject(e){this.removeTimeout(),super.reject(e)}resolve(e){this.removeTimeout(),super.resolve(e)}};var Fi=Ui;const ji=We;let Bi=class extends ji{constructor(e,t){super(t),this._creationTimestamp=Date.now(),this.pooledResource=e}reject(){}};var zi=Bi;const Hi={ALLOCATED:"ALLOCATED",IDLE:"IDLE",INVALID:"INVALID",RETURNING:"RETURNING",VALIDATION:"VALIDATION"};var Wi=Hi;const k=Wi;let Gi=class{constructor(e){this.creationTime=Date.now(),this.lastReturnTime=null,this.lastBorrowTime=null,this.lastIdleTime=null,this.obj=e,this.state=k.IDLE}allocate(){this.lastBorrowTime=Date.now(),this.state=k.ALLOCATED}deallocate(){this.lastReturnTime=Date.now(),this.state=k.IDLE}invalidate(){this.state=k.INVALID}test(){this.state=k.VALIDATION}idle(){this.lastIdleTime=Date.now(),this.state=k.IDLE}returning(){this.state=k.RETURNING}};var qi=Gi;let $i=class{evict(e,t,s){const r=Date.now()-t.lastIdleTime;return e.softIdleTimeoutMillis>0&&e.softIdleTimeoutMillis<r&&e.min<s||e.idleTimeoutMillis<r}};var Yi=$i;let Vi=class{constructor(){this.head=null,this.tail=null,this.length=0}insertBeginning(e){this.head===null?(this.head=e,this.tail=e,e.prev=null,e.next=null,this.length++):this.insertBefore(this.head,e)}insertEnd(e){this.tail===null?this.insertBeginning(e):this.insertAfter(this.tail,e)}insertAfter(e,t){t.prev=e,t.next=e.next,e.next===null?this.tail=t:e.next.prev=t,e.next=t,this.length++}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev===null?this.head=t:e.prev.next=t,e.prev=t,this.length++}remove(e){e.prev===null?this.head=e.next:e.prev.next=e.next,e.next===null?this.tail=e.prev:e.next.prev=e.prev,e.prev=null,e.next=null,this.length--}static createNode(e){return{prev:null,next:null,data:e}}};var jt=Vi;let Qi=class{constructor(e,t){this._list=e,this._direction=t===!0?"prev":"next",this._startPosition=t===!0?"tail":"head",this._started=!1,this._cursor=null,this._done=!1}_start(){this._cursor=this._list[this._startPosition],this._started=!0}_advanceCursor(){if(this._started===!1){this._started=!0,this._cursor=this._list[this._startPosition];return}this._cursor=this._cursor[this._direction]}reset(){this._done=!1,this._started=!1,this._cursor=null}remove(){if(this._started===!1||this._done===!0||this._isCursorDetached())return!1;this._list.remove(this._cursor)}next(){return this._done===!0?{done:!0}:(this._advanceCursor(),this._cursor===null||this._isCursorDetached()?(this._done=!0,{done:!0}):{value:this._cursor,done:!1})}_isCursorDetached(){return this._cursor.prev===null&&this._cursor.next===null&&this._list.tail!==this._cursor&&this._list.head!==this._cursor}};var Xi=Qi;const Ki=Xi;let Zi=class extends Ki{next(){const e=super.next();return e.value&&(e.value=e.value.data),e}};var Ji=Zi;const Pe=jt,Me=Ji;let en=class{constructor(){this._list=new Pe}shift(){if(this.length===0)return;const e=this._list.head;return this._list.remove(e),e.data}unshift(e){const t=Pe.createNode(e);this._list.insertBeginning(t)}push(e){const t=Pe.createNode(e);this._list.insertEnd(t)}pop(){if(this.length===0)return;const e=this._list.tail;return this._list.remove(e),e.data}[Symbol.iterator](){return new Me(this._list)}iterator(){return new Me(this._list)}reverseIterator(){return new Me(this._list,!0)}get head(){return this.length===0?void 0:this._list.head.data}get tail(){return this.length===0?void 0:this._list.tail.data}get length(){return this._list.length}};var Bt=en;const tn=jt,nn=Bt;let sn=class extends nn{push(e){const t=tn.createNode(e);e.promise.catch(this._createTimeoutRejectionHandler(t)),this._list.insertEnd(t)}_createTimeoutRejectionHandler(e){return t=>{t.name==="TimeoutError"&&this._list.remove(e)}}};var rn=sn;const on=rn;let an=class{constructor(e){this._size=Math.max(+e|0,1),this._slots=[];for(let t=0;t<this._size;t++)this._slots.push(new on)}get length(){let e=0;for(let t=0,s=this._slots.length;t<s;t++)e+=this._slots[t].length;return e}enqueue(e,t){t=t&&+t|0||0,t&&(t<0||t>=this._size)&&(t=this._size-1),this._slots[t].push(e)}dequeue(){for(let e=0,t=this._slots.length;e<t;e+=1)if(this._slots[e].length)return this._slots[e].shift()}get head(){for(let e=0,t=this._slots.length;e<t;e+=1)if(this._slots[e].length>0)return this._slots[e].head}get tail(){for(let e=this._slots.length-1;e>=0;e--)if(this._slots[e].length>0)return this._slots[e].tail}};var ln=an,zt={};function gt(){}zt.reflector=function(n){return n.then(gt,gt)};const un=Li.EventEmitter,cn=bi,fn=Ii,hn=Fi,mn=zi,dn=qi,_n=We,K=zt.reflector,pn="factoryCreateError",gn="factoryDestroyError";let Tn=class extends un{constructor(e,t,s,r,c){super(),cn(r),this._config=new fn(c),this._Promise=this._config.Promise,this._factory=r,this._draining=!1,this._started=!1,this._waitingClientsQueue=new s(this._config.priorityRange),this._factoryCreateOperations=new Set,this._factoryDestroyOperations=new Set,this._availableObjects=new t,this._testOnBorrowResources=new Set,this._testOnReturnResources=new Set,this._validationOperations=new Set,this._allObjects=new Set,this._resourceLoans=new Map,this._evictionIterator=this._availableObjects.iterator(),this._evictor=new e,this._scheduledEviction=null,this._config.autostart===!0&&this.start()}_destroy(e){e.invalidate(),this._allObjects.delete(e);const t=this._factory.destroy(e.obj),s=this._config.destroyTimeoutMillis?this._Promise.resolve(this._applyDestroyTimeout(t)):this._Promise.resolve(t);this._trackOperation(s,this._factoryDestroyOperations).catch(r=>{this.emit(gn,r)}),this._ensureMinimum()}_applyDestroyTimeout(e){const t=new this._Promise((s,r)=>{setTimeout(()=>{r(new Error("destroy timed out"))},this._config.destroyTimeoutMillis).unref()});return this._Promise.race([t,e])}_testOnBorrow(){if(this._availableObjects.length<1)return!1;const e=this._availableObjects.shift();e.test(),this._testOnBorrowResources.add(e);const t=this._factory.validate(e.obj),s=this._Promise.resolve(t);return this._trackOperation(s,this._validationOperations).then(r=>{if(this._testOnBorrowResources.delete(e),r===!1){e.invalidate(),this._destroy(e),this._dispense();return}this._dispatchPooledResourceToNextWaitingClient(e)}),!0}_dispatchResource(){if(this._availableObjects.length<1)return!1;const e=this._availableObjects.shift();return this._dispatchPooledResourceToNextWaitingClient(e),!1}_dispense(){const e=this._waitingClientsQueue.length;if(e<1)return;const t=e-this._potentiallyAllocableResourceCount,s=Math.min(this.spareResourceCapacity,t);for(let r=0;s>r;r++)this._createResource();if(this._config.testOnBorrow===!0){const r=e-this._testOnBorrowResources.size,c=Math.min(this._availableObjects.length,r);for(let u=0;c>u;u++)this._testOnBorrow()}if(this._config.testOnBorrow===!1){const r=Math.min(this._availableObjects.length,e);for(let c=0;r>c;c++)this._dispatchResource()}}_dispatchPooledResourceToNextWaitingClient(e){const t=this._waitingClientsQueue.dequeue();if(t===void 0||t.state!==_n.PENDING)return this._addPooledResourceToAvailableObjects(e),!1;const s=new mn(e,this._Promise);return this._resourceLoans.set(e.obj,s),e.allocate(),t.resolve(e.obj),!0}_trackOperation(e,t){return t.add(e),e.then(s=>(t.delete(e),this._Promise.resolve(s)),s=>(t.delete(e),this._Promise.reject(s)))}_createResource(){const e=this._factory.create(),t=this._Promise.resolve(e).then(s=>{const r=new dn(s);this._allObjects.add(r),this._addPooledResourceToAvailableObjects(r)});this._trackOperation(t,this._factoryCreateOperations).then(()=>(this._dispense(),null)).catch(s=>{this.emit(pn,s),this._dispense()})}_ensureMinimum(){if(this._draining===!0)return;const e=this._config.min-this._count;for(let t=0;t<e;t++)this._createResource()}_evict(){const e=Math.min(this._config.numTestsPerEvictionRun,this._availableObjects.length),t={softIdleTimeoutMillis:this._config.softIdleTimeoutMillis,idleTimeoutMillis:this._config.idleTimeoutMillis,min:this._config.min};for(let s=0;s<e;){const r=this._evictionIterator.next();if(r.done===!0&&this._availableObjects.length<1){this._evictionIterator.reset();return}if(r.done===!0&&this._availableObjects.length>0){this._evictionIterator.reset();continue}const c=r.value,u=this._evictor.evict(t,c,this._availableObjects.length);s++,u===!0&&(this._evictionIterator.remove(),this._destroy(c))}}_scheduleEvictorRun(){this._config.evictionRunIntervalMillis>0&&(this._scheduledEviction=setTimeout(()=>{this._evict(),this._scheduleEvictorRun()},this._config.evictionRunIntervalMillis).unref())}_descheduleEvictorRun(){this._scheduledEviction&&clearTimeout(this._scheduledEviction),this._scheduledEviction=null}start(){this._draining!==!0&&this._started!==!0&&(this._started=!0,this._scheduleEvictorRun(),this._ensureMinimum())}acquire(e){if(this._started===!1&&this._config.autostart===!1&&this.start(),this._draining)return this._Promise.reject(new Error("pool is draining and cannot accept work"));if(this.spareResourceCapacity<1&&this._availableObjects.length<1&&this._config.maxWaitingClients!==void 0&&this._waitingClientsQueue.length>=this._config.maxWaitingClients)return this._Promise.reject(new Error("max waitingClients count exceeded"));const t=new hn(this._config.acquireTimeoutMillis,this._Promise);return this._waitingClientsQueue.enqueue(t,e),this._dispense(),t.promise}use(e,t){return this.acquire(t).then(s=>e(s).then(r=>(this.release(s),r),r=>{throw this.destroy(s),r}))}isBorrowedResource(e){return this._resourceLoans.has(e)}release(e){const t=this._resourceLoans.get(e);if(t===void 0)return this._Promise.reject(new Error("Resource not currently part of this pool"));this._resourceLoans.delete(e),t.resolve();const s=t.pooledResource;return s.deallocate(),this._addPooledResourceToAvailableObjects(s),this._dispense(),this._Promise.resolve()}destroy(e){const t=this._resourceLoans.get(e);if(t===void 0)return this._Promise.reject(new Error("Resource not currently part of this pool"));this._resourceLoans.delete(e),t.resolve();const s=t.pooledResource;return s.deallocate(),this._destroy(s),this._dispense(),this._Promise.resolve()}_addPooledResourceToAvailableObjects(e){e.idle(),this._config.fifo===!0?this._availableObjects.push(e):this._availableObjects.unshift(e)}drain(){return this._draining=!0,this.__allResourceRequestsSettled().then(()=>this.__allResourcesReturned()).then(()=>{this._descheduleEvictorRun()})}__allResourceRequestsSettled(){return this._waitingClientsQueue.length>0?K(this._waitingClientsQueue.tail.promise):this._Promise.resolve()}__allResourcesReturned(){const e=Array.from(this._resourceLoans.values()).map(t=>t.promise).map(K);return this._Promise.all(e)}clear(){const e=Array.from(this._factoryCreateOperations).map(K);return this._Promise.all(e).then(()=>{for(const s of this._availableObjects)this._destroy(s);const t=Array.from(this._factoryDestroyOperations).map(K);return K(this._Promise.all(t))})}ready(){return new this._Promise(e=>{const t=()=>{this.available>=this.min?e():setTimeout(t,100)};t()})}get _potentiallyAllocableResourceCount(){return this._availableObjects.length+this._testOnBorrowResources.size+this._testOnReturnResources.size+this._factoryCreateOperations.size}get _count(){return this._allObjects.size+this._factoryCreateOperations.size}get spareResourceCapacity(){return this._config.max-(this._allObjects.size+this._factoryCreateOperations.size)}get size(){return this._count}get available(){return this._availableObjects.length}get borrowed(){return this._resourceLoans.size}get pending(){return this._waitingClientsQueue.length}get max(){return this._config.max}get min(){return this._config.min}};var En=Tn;const Tt=En,Et=Bt,vt=ln,Rt=Yi;var vn={Pool:Tt,Deque:Et,PriorityQueue:vt,DefaultEvictor:Rt,createPool:function(n,e){return new Tt(Rt,Et,vt,n,e)}};const Rn=gi(vn),At=Rn.createPool({create:async()=>new MessageChannel,destroy:async n=>{n.port1.close(),n.port2.close()}},{min:3,max:3});function An(n,e){(e==null||isNaN(e)||e<0)&&(e=0),e<1?At.acquire().then(t=>{t.port1.onmessage=()=>{At.release(t),n()},t.port2.postMessage("")}):setTimeout(n,e)}function yn(n,e){if(e<1){let t=new MessageChannel;t.port1.onmessage=()=>{n()},t.port2.postMessage("")}else setTimeout(n,e)}const Ht=new MessageChannel,Wt=[];Ht.port1.onmessage=()=>{Wt.pop()()};const Ln=function(n,e){(e==null||isNaN(e)||e<0)&&(e=0),e<1?(Wt.push(n),Ht.port2.postMessage(void 0)):setTimeout(n,e)},bn=async n=>{n()},On=(n,e)=>{(e==null||isNaN(e)||e<0)&&(e=0),e<1?bn(n):setTimeout(n,e)};let _e=n=>e=>new Promise(t=>n(t,e));const ss=_e(Ln),rs=_e(An),wn=_e(yn),os=_e(On),as=wn;/*! @license DOMPurify 3.0.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.6/LICENSE */const{entries:Gt,setPrototypeOf:yt,isFrozen:Dn,getPrototypeOf:Sn,getOwnPropertyDescriptor:qt}=Object;let{freeze:A,seal:w,create:$t}=Object,{apply:Be,construct:ze}=typeof Reflect<"u"&&Reflect;A||(A=function(e){return e});w||(w=function(e){return e});Be||(Be=function(e,t,s){return e.apply(t,s)});ze||(ze=function(e,t){return new e(...t)});const le=O(Array.prototype.forEach),Lt=O(Array.prototype.pop),Z=O(Array.prototype.push),he=O(String.prototype.toLowerCase),xe=O(String.prototype.toString),In=O(String.prototype.match),J=O(String.prototype.replace),Nn=O(String.prototype.indexOf),Cn=O(String.prototype.trim),b=O(RegExp.prototype.test),ee=Pn(TypeError);function O(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return Be(n,e,s)}}function Pn(n){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return ze(n,t)}}function f(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:he;yt&&yt(n,null);let s=e.length;for(;s--;){let r=e[s];if(typeof r=="string"){const c=t(r);c!==r&&(Dn(e)||(e[s]=c),r=c)}n[r]=!0}return n}function G(n){const e=$t(null);for(const[t,s]of Gt(n))qt(n,t)!==void 0&&(e[t]=s);return e}function ue(n,e){for(;n!==null;){const s=qt(n,e);if(s){if(s.get)return O(s.get);if(typeof s.value=="function")return O(s.value)}n=Sn(n)}function t(s){return console.warn("fallback value for",s),null}return t}const bt=A(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ke=A(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ue=A(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Mn=A(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fe=A(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),xn=A(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ot=A(["#text"]),wt=A(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),je=A(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Dt=A(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ce=A(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kn=w(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Un=w(/<%[\w\W]*|[\w\W]*%>/gm),Fn=w(/\${[\w\W]*}/gm),jn=w(/^data-[\-\w.\u00B7-\uFFFF]/),Bn=w(/^aria-[\-\w]+$/),Yt=w(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),zn=w(/^(?:\w+script|data):/i),Hn=w(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Vt=w(/^html$/i);var St=Object.freeze({__proto__:null,MUSTACHE_EXPR:kn,ERB_EXPR:Un,TMPLIT_EXPR:Fn,DATA_ATTR:jn,ARIA_ATTR:Bn,IS_ALLOWED_URI:Yt,IS_SCRIPT_OR_DATA:zn,ATTR_WHITESPACE:Hn,DOCTYPE_NAME:Vt});const Wn=function(){return typeof window>"u"?null:window},Gn=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(s=t.getAttribute(r));const c="dompurify"+(s?"#"+s:"");try{return e.createPolicy(c,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+c+" could not be created."),null}};function Qt(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wn();const e=l=>Qt(l);if(e.version="3.0.6",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;let{document:t}=n;const s=t,r=s.currentScript,{DocumentFragment:c,HTMLTemplateElement:u,Node:v,Element:N,NodeFilter:U,NamedNodeMap:pe=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:Xt,DOMParser:Kt,trustedTypes:te}=n,ie=N.prototype,Zt=ue(ie,"cloneNode"),Jt=ue(ie,"nextSibling"),ei=ue(ie,"childNodes"),ge=ue(ie,"parentNode");if(typeof u=="function"){const l=t.createElement("template");l.content&&l.content.ownerDocument&&(t=l.content.ownerDocument)}let R,Y="";const{implementation:Te,createNodeIterator:ti,createDocumentFragment:ii,getElementsByTagName:ni}=t,{importNode:si}=s;let D={};e.isSupported=typeof Gt=="function"&&typeof ge=="function"&&Te&&Te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ee,ERB_EXPR:ve,TMPLIT_EXPR:Re,DATA_ATTR:ri,ARIA_ATTR:oi,IS_SCRIPT_OR_DATA:ai,ATTR_WHITESPACE:Ge}=St;let{IS_ALLOWED_URI:qe}=St,_=null;const $e=f({},[...bt,...ke,...Ue,...Fe,...Ot]);let p=null;const Ye=f({},[...wt,...je,...Dt,...ce]);let d=Object.seal($t(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,Ae=null,Ve=!0,ye=!0,Qe=!1,Xe=!0,F=!1,C=!1,Le=!1,be=!1,j=!1,ne=!1,se=!1,Ke=!0,Ze=!1;const li="user-content-";let Oe=!0,Q=!1,B={},z=null;const Je=f({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let et=null;const tt=f({},["audio","video","img","source","image","track"]);let we=null;const it=f({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),re="http://www.w3.org/1998/Math/MathML",oe="http://www.w3.org/2000/svg",S="http://www.w3.org/1999/xhtml";let H=S,De=!1,Se=null;const ui=f({},[re,oe,S],xe);let P=null;const ci=["application/xhtml+xml","text/html"],fi="text/html";let g=null,W=null;const hi=t.createElement("form"),nt=function(i){return i instanceof RegExp||i instanceof Function},Ie=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(W&&W===i)){if((!i||typeof i!="object")&&(i={}),i=G(i),P=ci.indexOf(i.PARSER_MEDIA_TYPE)===-1?P=fi:P=i.PARSER_MEDIA_TYPE,g=P==="application/xhtml+xml"?xe:he,_="ALLOWED_TAGS"in i?f({},i.ALLOWED_TAGS,g):$e,p="ALLOWED_ATTR"in i?f({},i.ALLOWED_ATTR,g):Ye,Se="ALLOWED_NAMESPACES"in i?f({},i.ALLOWED_NAMESPACES,xe):ui,we="ADD_URI_SAFE_ATTR"in i?f(G(it),i.ADD_URI_SAFE_ATTR,g):it,et="ADD_DATA_URI_TAGS"in i?f(G(tt),i.ADD_DATA_URI_TAGS,g):tt,z="FORBID_CONTENTS"in i?f({},i.FORBID_CONTENTS,g):Je,V="FORBID_TAGS"in i?f({},i.FORBID_TAGS,g):{},Ae="FORBID_ATTR"in i?f({},i.FORBID_ATTR,g):{},B="USE_PROFILES"in i?i.USE_PROFILES:!1,Ve=i.ALLOW_ARIA_ATTR!==!1,ye=i.ALLOW_DATA_ATTR!==!1,Qe=i.ALLOW_UNKNOWN_PROTOCOLS||!1,Xe=i.ALLOW_SELF_CLOSE_IN_ATTR!==!1,F=i.SAFE_FOR_TEMPLATES||!1,C=i.WHOLE_DOCUMENT||!1,j=i.RETURN_DOM||!1,ne=i.RETURN_DOM_FRAGMENT||!1,se=i.RETURN_TRUSTED_TYPE||!1,be=i.FORCE_BODY||!1,Ke=i.SANITIZE_DOM!==!1,Ze=i.SANITIZE_NAMED_PROPS||!1,Oe=i.KEEP_CONTENT!==!1,Q=i.IN_PLACE||!1,qe=i.ALLOWED_URI_REGEXP||Yt,H=i.NAMESPACE||S,d=i.CUSTOM_ELEMENT_HANDLING||{},i.CUSTOM_ELEMENT_HANDLING&&nt(i.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(d.tagNameCheck=i.CUSTOM_ELEMENT_HANDLING.tagNameCheck),i.CUSTOM_ELEMENT_HANDLING&&nt(i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(d.attributeNameCheck=i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),i.CUSTOM_ELEMENT_HANDLING&&typeof i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(d.allowCustomizedBuiltInElements=i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),F&&(ye=!1),ne&&(j=!0),B&&(_=f({},[...Ot]),p=[],B.html===!0&&(f(_,bt),f(p,wt)),B.svg===!0&&(f(_,ke),f(p,je),f(p,ce)),B.svgFilters===!0&&(f(_,Ue),f(p,je),f(p,ce)),B.mathMl===!0&&(f(_,Fe),f(p,Dt),f(p,ce))),i.ADD_TAGS&&(_===$e&&(_=G(_)),f(_,i.ADD_TAGS,g)),i.ADD_ATTR&&(p===Ye&&(p=G(p)),f(p,i.ADD_ATTR,g)),i.ADD_URI_SAFE_ATTR&&f(we,i.ADD_URI_SAFE_ATTR,g),i.FORBID_CONTENTS&&(z===Je&&(z=G(z)),f(z,i.FORBID_CONTENTS,g)),Oe&&(_["#text"]=!0),C&&f(_,["html","head","body"]),_.table&&(f(_,["tbody"]),delete V.tbody),i.TRUSTED_TYPES_POLICY){if(typeof i.TRUSTED_TYPES_POLICY.createHTML!="function")throw ee('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof i.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ee('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=i.TRUSTED_TYPES_POLICY,Y=R.createHTML("")}else R===void 0&&(R=Gn(te,r)),R!==null&&typeof Y=="string"&&(Y=R.createHTML(""));A&&A(i),W=i}},st=f({},["mi","mo","mn","ms","mtext"]),rt=f({},["foreignobject","desc","title","annotation-xml"]),mi=f({},["title","style","font","a","script"]),ae=f({},ke);f(ae,Ue),f(ae,Mn);const Ne=f({},Fe);f(Ne,xn);const di=function(i){let o=ge(i);(!o||!o.tagName)&&(o={namespaceURI:H,tagName:"template"});const a=he(i.tagName),m=he(o.tagName);return Se[i.namespaceURI]?i.namespaceURI===oe?o.namespaceURI===S?a==="svg":o.namespaceURI===re?a==="svg"&&(m==="annotation-xml"||st[m]):!!ae[a]:i.namespaceURI===re?o.namespaceURI===S?a==="math":o.namespaceURI===oe?a==="math"&&rt[m]:!!Ne[a]:i.namespaceURI===S?o.namespaceURI===oe&&!rt[m]||o.namespaceURI===re&&!st[m]?!1:!Ne[a]&&(mi[a]||!ae[a]):!!(P==="application/xhtml+xml"&&Se[i.namespaceURI]):!1},M=function(i){Z(e.removed,{element:i});try{i.parentNode.removeChild(i)}catch{i.remove()}},Ce=function(i,o){try{Z(e.removed,{attribute:o.getAttributeNode(i),from:o})}catch{Z(e.removed,{attribute:null,from:o})}if(o.removeAttribute(i),i==="is"&&!p[i])if(j||ne)try{M(o)}catch{}else try{o.setAttribute(i,"")}catch{}},ot=function(i){let o=null,a=null;if(be)i="<remove></remove>"+i;else{const E=In(i,/^[\r\n\t ]+/);a=E&&E[0]}P==="application/xhtml+xml"&&H===S&&(i='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+i+"</body></html>");const m=R?R.createHTML(i):i;if(H===S)try{o=new Kt().parseFromString(m,P)}catch{}if(!o||!o.documentElement){o=Te.createDocument(H,"template",null);try{o.documentElement.innerHTML=De?Y:m}catch{}}const T=o.body||o.documentElement;return i&&a&&T.insertBefore(t.createTextNode(a),T.childNodes[0]||null),H===S?ni.call(o,C?"html":"body")[0]:C?o.documentElement:T},at=function(i){return ti.call(i.ownerDocument||i,i,U.SHOW_ELEMENT|U.SHOW_COMMENT|U.SHOW_TEXT,null)},_i=function(i){return i instanceof Xt&&(typeof i.nodeName!="string"||typeof i.textContent!="string"||typeof i.removeChild!="function"||!(i.attributes instanceof pe)||typeof i.removeAttribute!="function"||typeof i.setAttribute!="function"||typeof i.namespaceURI!="string"||typeof i.insertBefore!="function"||typeof i.hasChildNodes!="function")},lt=function(i){return typeof v=="function"&&i instanceof v},I=function(i,o,a){D[i]&&le(D[i],m=>{m.call(e,o,a,W)})},ut=function(i){let o=null;if(I("beforeSanitizeElements",i,null),_i(i))return M(i),!0;const a=g(i.nodeName);if(I("uponSanitizeElement",i,{tagName:a,allowedTags:_}),i.hasChildNodes()&&!lt(i.firstElementChild)&&b(/<[/\w]/g,i.innerHTML)&&b(/<[/\w]/g,i.textContent))return M(i),!0;if(!_[a]||V[a]){if(!V[a]&&ft(a)&&(d.tagNameCheck instanceof RegExp&&b(d.tagNameCheck,a)||d.tagNameCheck instanceof Function&&d.tagNameCheck(a)))return!1;if(Oe&&!z[a]){const m=ge(i)||i.parentNode,T=ei(i)||i.childNodes;if(T&&m){const E=T.length;for(let y=E-1;y>=0;--y)m.insertBefore(Zt(T[y],!0),Jt(i))}}return M(i),!0}return i instanceof N&&!di(i)||(a==="noscript"||a==="noembed"||a==="noframes")&&b(/<\/no(script|embed|frames)/i,i.innerHTML)?(M(i),!0):(F&&i.nodeType===3&&(o=i.textContent,le([Ee,ve,Re],m=>{o=J(o,m," ")}),i.textContent!==o&&(Z(e.removed,{element:i.cloneNode()}),i.textContent=o)),I("afterSanitizeElements",i,null),!1)},ct=function(i,o,a){if(Ke&&(o==="id"||o==="name")&&(a in t||a in hi))return!1;if(!(ye&&!Ae[o]&&b(ri,o))){if(!(Ve&&b(oi,o))){if(!p[o]||Ae[o]){if(!(ft(i)&&(d.tagNameCheck instanceof RegExp&&b(d.tagNameCheck,i)||d.tagNameCheck instanceof Function&&d.tagNameCheck(i))&&(d.attributeNameCheck instanceof RegExp&&b(d.attributeNameCheck,o)||d.attributeNameCheck instanceof Function&&d.attributeNameCheck(o))||o==="is"&&d.allowCustomizedBuiltInElements&&(d.tagNameCheck instanceof RegExp&&b(d.tagNameCheck,a)||d.tagNameCheck instanceof Function&&d.tagNameCheck(a))))return!1}else if(!we[o]){if(!b(qe,J(a,Ge,""))){if(!((o==="src"||o==="xlink:href"||o==="href")&&i!=="script"&&Nn(a,"data:")===0&&et[i])){if(!(Qe&&!b(ai,J(a,Ge,"")))){if(a)return!1}}}}}}return!0},ft=function(i){return i.indexOf("-")>0},ht=function(i){I("beforeSanitizeAttributes",i,null);const{attributes:o}=i;if(!o)return;const a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:p};let m=o.length;for(;m--;){const T=o[m],{name:E,namespaceURI:y,value:x}=T,X=g(E);let L=E==="value"?x:Cn(x);if(a.attrName=X,a.attrValue=L,a.keepAttr=!0,a.forceKeepAttr=void 0,I("uponSanitizeAttribute",i,a),L=a.attrValue,a.forceKeepAttr||(Ce(E,i),!a.keepAttr))continue;if(!Xe&&b(/\/>/i,L)){Ce(E,i);continue}F&&le([Ee,ve,Re],dt=>{L=J(L,dt," ")});const mt=g(i.nodeName);if(ct(mt,X,L)){if(Ze&&(X==="id"||X==="name")&&(Ce(E,i),L=li+L),R&&typeof te=="object"&&typeof te.getAttributeType=="function"&&!y)switch(te.getAttributeType(mt,X)){case"TrustedHTML":{L=R.createHTML(L);break}case"TrustedScriptURL":{L=R.createScriptURL(L);break}}try{y?i.setAttributeNS(y,E,L):i.setAttribute(E,L),Lt(e.removed)}catch{}}}I("afterSanitizeAttributes",i,null)},pi=function l(i){let o=null;const a=at(i);for(I("beforeSanitizeShadowDOM",i,null);o=a.nextNode();)I("uponSanitizeShadowNode",o,null),!ut(o)&&(o.content instanceof c&&l(o.content),ht(o));I("afterSanitizeShadowDOM",i,null)};return e.sanitize=function(l){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=null,a=null,m=null,T=null;if(De=!l,De&&(l="<!-->"),typeof l!="string"&&!lt(l))if(typeof l.toString=="function"){if(l=l.toString(),typeof l!="string")throw ee("dirty is not a string, aborting")}else throw ee("toString is not a function");if(!e.isSupported)return l;if(Le||Ie(i),e.removed=[],typeof l=="string"&&(Q=!1),Q){if(l.nodeName){const x=g(l.nodeName);if(!_[x]||V[x])throw ee("root node is forbidden and cannot be sanitized in-place")}}else if(l instanceof v)o=ot("<!---->"),a=o.ownerDocument.importNode(l,!0),a.nodeType===1&&a.nodeName==="BODY"||a.nodeName==="HTML"?o=a:o.appendChild(a);else{if(!j&&!F&&!C&&l.indexOf("<")===-1)return R&&se?R.createHTML(l):l;if(o=ot(l),!o)return j?null:se?Y:""}o&&be&&M(o.firstChild);const E=at(Q?l:o);for(;m=E.nextNode();)ut(m)||(m.content instanceof c&&pi(m.content),ht(m));if(Q)return l;if(j){if(ne)for(T=ii.call(o.ownerDocument);o.firstChild;)T.appendChild(o.firstChild);else T=o;return(p.shadowroot||p.shadowrootmode)&&(T=si.call(s,T,!0)),T}let y=C?o.outerHTML:o.innerHTML;return C&&_["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&b(Vt,o.ownerDocument.doctype.name)&&(y="<!DOCTYPE "+o.ownerDocument.doctype.name+`>
`+y),F&&le([Ee,ve,Re],x=>{y=J(y,x," ")}),R&&se?R.createHTML(y):y},e.setConfig=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ie(l),Le=!0},e.clearConfig=function(){W=null,Le=!1},e.isValidAttribute=function(l,i,o){W||Ie({});const a=g(l),m=g(i);return ct(a,m,o)},e.addHook=function(l,i){typeof i=="function"&&(D[l]=D[l]||[],Z(D[l],i))},e.removeHook=function(l){if(D[l])return Lt(D[l])},e.removeHooks=function(l){D[l]&&(D[l]=[])},e.removeAllHooks=function(){D={}},e}var ls=Qt();export{ss as a,os as b,qn as c,as as d,gi as g,ls as p,rs as s};
//# sourceMappingURL=purify.es-_0EJVn3H.js.map
