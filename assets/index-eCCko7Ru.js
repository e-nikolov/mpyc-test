import{E as X}from"./encode-79CO1kuF.js";import{B as re}from"./index-75u6hiV6.js";var yt,h,J;try{yt=new TextDecoder}catch{}var v,K,T,$,S,n=0,B={},L=0,W=0,V=[],jt={useRecords:!1,mapsAsObjects:!0};class Tt{}const Mt=new Tt;Mt.name="MessagePack 0xC1";var Z=!1,Rt=2;try{new Function("")}catch{Rt=1/0}class it{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.sequential&&t.trusted!==!1&&(t.trusted=!0,t.structures||t.useRecords==0||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,e){if(h)return qt(()=>(vt(),this?this.unpack(t,e):it.prototype.unpack.call(jt,t,e)));t.buffer||t.constructor!==ArrayBuffer||(t=typeof Buffer<"u"?Buffer.from(t):new Uint8Array(t)),typeof e=="object"?(J=e.end||t.length,n=e.start||0):(n=0,J=e>-1?e:t.length),W=0,K=null,T=null,h=t;try{S=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(u){throw h=null,t instanceof Uint8Array?u:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof it){if(B=this,this.structures)return v=this.structures,lt(e);(!v||v.length>0)&&(v=[])}else B=jt,(!v||v.length>0)&&(v=[]);return lt(e)}unpackMultiple(t,e){let u,s=0;try{Z=!0;let l=t.length,d=this?this.unpack(t,l):ct.unpack(t,l);if(!e){for(u=[d];n<l;)s=n,u.push(lt());return u}if(e(d,s,n)===!1)return;for(;n<l;)if(s=n,e(lt(),s,n)===!1)return}catch(l){throw l.lastPosition=s,l.values=u,l}finally{Z=!1,vt()}}_mergeStructures(t,e){t=t||[],Object.isFrozen(t)&&(t=t.map(u=>u.slice(0)));for(let u=0,s=t.length;u<s;u++){let l=t[u];l&&(l.isShared=!0,u>=32&&(l.highByte=u-32>>5))}t.sharedLength=t.length;for(let u in e||[])if(u>=0){let s=t[u],l=e[u];l&&(s&&((t.restoreStructures||(t.restoreStructures=[]))[u]=s),t[u]=l)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function lt(r){try{if(!B.trusted&&!Z){let e=v.sharedLength||0;e<v.length&&(v.length=e)}let t;if(B.randomAccessStructure&&h[n]<64&&h[n],t=_(),T&&(n=T.postBundlePosition,T=null),Z&&(v.restoreStructures=null),n==J)v&&v.restoreStructures&&Nt(),v=null,h=null,$&&($=null);else{if(n>J)throw new Error("Unexpected end of MessagePack data");if(!Z){let e;try{e=JSON.stringify(t,(u,s)=>typeof s=="bigint"?`${s}n`:s).slice(0,100)}catch(u){e="(JSON view not available "+u+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(t){throw v&&v.restoreStructures&&Nt(),vt(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||n>J)&&(t.incomplete=!0),t}}function Nt(){for(let r in v.restoreStructures)v[r]=v.restoreStructures[r];v.restoreStructures=null}function _(){let r=h[n++];if(r<160){if(r<128){if(r<64)return r;{let t=v[63&r]||B.getStructures&&Vt()[63&r];return t?(t.read||(t.read=bt(t,63&r)),t.read()):r}}if(r<144){if(r-=128,B.mapsAsObjects){let t={};for(let e=0;e<r;e++){let u=Jt();u==="__proto__"&&(u="__proto_"),t[u]=_()}return t}{let t=new Map;for(let e=0;e<r;e++)t.set(_(),_());return t}}{r-=144;let t=new Array(r);for(let e=0;e<r;e++)t[e]=_();return B.freezeData?Object.freeze(t):t}}if(r<192){let t=r-160;if(W>=n)return K.slice(n-L,(n+=t)-L);if(W==0&&J<140){let e=t<16?St(t):Ct(t);if(e!=null)return e}return mt(t)}{let t;switch(r){case 192:return null;case 193:return T?(t=_(),t>0?T[1].slice(T.position1,T.position1+=t):T[0].slice(T.position0,T.position0-=t)):Mt;case 194:return!1;case 195:return!0;case 196:if(t=h[n++],t===void 0)throw new Error("Unexpected end of buffer");return Ut(t);case 197:return t=S.getUint16(n),n+=2,Ut(t);case 198:return t=S.getUint32(n),n+=4,Ut(t);case 199:return H(h[n++]);case 200:return t=S.getUint16(n),n+=2,H(t);case 201:return t=S.getUint32(n),n+=4,H(t);case 202:if(t=S.getFloat32(n),B.useFloat32>2){let e=At[(127&h[n])<<1|h[n+1]>>7];return n+=4,(e*t+(t>0?.5:-.5)>>0)/e}return n+=4,t;case 203:return t=S.getFloat64(n),n+=8,t;case 204:return h[n++];case 205:return t=S.getUint16(n),n+=2,t;case 206:return t=S.getUint32(n),n+=4,t;case 207:return B.int64AsType==="number"?(t=4294967296*S.getUint32(n),t+=S.getUint32(n+4)):B.int64AsType==="string"?t=S.getBigUint64(n).toString():B.int64AsType==="auto"?(t=S.getBigUint64(n),t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=S.getBigUint64(n),n+=8,t;case 208:return S.getInt8(n++);case 209:return t=S.getInt16(n),n+=2,t;case 210:return t=S.getInt32(n),n+=4,t;case 211:return B.int64AsType==="number"?(t=4294967296*S.getInt32(n),t+=S.getUint32(n+4)):B.int64AsType==="string"?t=S.getBigInt64(n).toString():B.int64AsType==="auto"?(t=S.getBigInt64(n),t>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t))):t=S.getBigInt64(n),n+=8,t;case 212:if(t=h[n++],t==114)return Wt(63&h[n++]);{let e=V[t];if(e)return e.read?(n++,e.read(_())):e.noBuffer?(n++,e()):e(h.subarray(n,++n));throw new Error("Unknown extension "+t)}case 213:return t=h[n],t==114?(n++,Wt(63&h[n++],h[n++])):H(2);case 214:return H(4);case 215:return H(8);case 216:return H(16);case 217:return t=h[n++],W>=n?K.slice(n-L,(n+=t)-L):ie(t);case 218:return t=S.getUint16(n),W>=(n+=2)?K.slice(n-L,(n+=t)-L):se(t);case 219:return t=S.getUint32(n),W>=(n+=4)?K.slice(n-L,(n+=t)-L):oe(t);case 220:return t=S.getUint16(n),n+=2,Ft(t);case 221:return t=S.getUint32(n),n+=4,Ft(t);case 222:return t=S.getUint16(n),n+=2,zt(t);case 223:return t=S.getUint32(n),n+=4,zt(t);default:if(r>=224)return r-256;if(r===void 0){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+r)}}}const ne=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function bt(r,t){function e(){if(e.count++>Rt){let s=r.read=new Function("r","return function(){return "+(B.freezeData?"Object.freeze":"")+"({"+r.map(l=>l==="__proto__"?"__proto_:r()":ne.test(l)?l+":r()":"["+JSON.stringify(l)+"]:r()").join(",")+"})}")(_);return r.highByte===0&&(r.read=Dt(t,r.read)),s()}let u={};for(let s=0,l=r.length;s<l;s++){let d=r[s];d==="__proto__"&&(d="__proto_"),u[d]=_()}return B.freezeData?Object.freeze(u):u}return e.count=0,r.highByte===0?Dt(t,e):e}const Dt=(r,t)=>function(){let e=h[n++];if(e===0)return t();let u=r<32?-(r+(e<<5)):r+(e<<5),s=v[u]||Vt()[u];if(!s)throw new Error("Record id is not defined for "+u);return s.read||(s.read=bt(s,r)),s.read()};function Vt(){let r=qt(()=>(h=null,B.getStructures()));return v=B._mergeStructures(r,v)}var mt=rt,ie=rt,se=rt,oe=rt;function rt(r){let t;if(r<16&&(t=St(r)))return t;if(r>64&&yt)return yt.decode(h.subarray(n,n+=r));const e=n+r,u=[];for(t="";n<e;){const s=h[n++];if(!(128&s))u.push(s);else if((224&s)==192){const l=63&h[n++];u.push((31&s)<<6|l)}else if((240&s)==224){const l=63&h[n++],d=63&h[n++];u.push((31&s)<<12|l<<6|d)}else if((248&s)==240){let l=(7&s)<<18|(63&h[n++])<<12|(63&h[n++])<<6|63&h[n++];l>65535&&(l-=65536,u.push(l>>>10&1023|55296),l=56320|1023&l),u.push(l)}else u.push(s);u.length>=4096&&(t+=E.apply(String,u),u.length=0)}return u.length>0&&(t+=E.apply(String,u)),t}function Ft(r){let t=new Array(r);for(let e=0;e<r;e++)t[e]=_();return B.freezeData?Object.freeze(t):t}function zt(r){if(B.mapsAsObjects){let t={};for(let e=0;e<r;e++){let u=Jt();u==="__proto__"&&(u="__proto_"),t[u]=_()}return t}{let t=new Map;for(let e=0;e<r;e++)t.set(_(),_());return t}}var E=String.fromCharCode;function Ct(r){let t=n,e=new Array(r);for(let u=0;u<r;u++){const s=h[n++];if((128&s)>0)return void(n=t);e[u]=s}return E.apply(String,e)}function St(r){if(r<4){if(r<2){if(r===0)return"";{let t=h[n++];return(128&t)>1?void(n-=1):E(t)}}{let t=h[n++],e=h[n++];if((128&t)>0||(128&e)>0)return void(n-=2);if(r<3)return E(t,e);let u=h[n++];return(128&u)>0?void(n-=3):E(t,e,u)}}{let t=h[n++],e=h[n++],u=h[n++],s=h[n++];if((128&t)>0||(128&e)>0||(128&u)>0||(128&s)>0)return void(n-=4);if(r<6){if(r===4)return E(t,e,u,s);{let l=h[n++];return(128&l)>0?void(n-=5):E(t,e,u,s,l)}}if(r<8){let l=h[n++],d=h[n++];if((128&l)>0||(128&d)>0)return void(n-=6);if(r<7)return E(t,e,u,s,l,d);let A=h[n++];return(128&A)>0?void(n-=7):E(t,e,u,s,l,d,A)}{let l=h[n++],d=h[n++],A=h[n++],N=h[n++];if((128&l)>0||(128&d)>0||(128&A)>0||(128&N)>0)return void(n-=8);if(r<10){if(r===8)return E(t,e,u,s,l,d,A,N);{let j=h[n++];return(128&j)>0?void(n-=9):E(t,e,u,s,l,d,A,N,j)}}if(r<12){let j=h[n++],x=h[n++];if((128&j)>0||(128&x)>0)return void(n-=10);if(r<11)return E(t,e,u,s,l,d,A,N,j,x);let M=h[n++];return(128&M)>0?void(n-=11):E(t,e,u,s,l,d,A,N,j,x,M)}{let j=h[n++],x=h[n++],M=h[n++],P=h[n++];if((128&j)>0||(128&x)>0||(128&M)>0||(128&P)>0)return void(n-=12);if(r<14){if(r===12)return E(t,e,u,s,l,d,A,N,j,x,M,P);{let F=h[n++];return(128&F)>0?void(n-=13):E(t,e,u,s,l,d,A,N,j,x,M,P,F)}}{let F=h[n++],G=h[n++];if((128&F)>0||(128&G)>0)return void(n-=14);if(r<15)return E(t,e,u,s,l,d,A,N,j,x,M,P,F,G);let z=h[n++];return(128&z)>0?void(n-=15):E(t,e,u,s,l,d,A,N,j,x,M,P,F,G,z)}}}}}function Lt(){let r,t=h[n++];if(t<192)r=t-160;else switch(t){case 217:r=h[n++];break;case 218:r=S.getUint16(n),n+=2;break;case 219:r=S.getUint32(n),n+=4;break;default:throw new Error("Expected string")}return rt(r)}function Ut(r){return B.copyBuffers?Uint8Array.prototype.slice.call(h,n,n+=r):h.subarray(n,n+=r)}function H(r){let t=h[n++];if(V[t]){let e;return V[t](h.subarray(n,e=n+=r),u=>{n=u;try{return _()}finally{n=e}})}throw new Error("Unknown extension type "+t)}var Pt=new Array(4096);function Jt(){let r=h[n++];if(!(r>=160&&r<192))return n--,_().toString();if(r-=160,W>=n)return K.slice(n-L,(n+=r)-L);if(!(W==0&&J<180))return mt(r);let t,e=4095&(r<<5^(r>1?S.getUint16(n):r>0?h[n]:0)),u=Pt[e],s=n,l=n+r-3,d=0;if(u&&u.bytes==r){for(;s<l;){if(t=S.getUint32(s),t!=u[d++]){s=1879048192;break}s+=4}for(l+=3;s<l;)if(t=h[s++],t!=u[d++]){s=1879048192;break}if(s===l)return n=s,u.string;l-=3,s=n}for(u=[],Pt[e]=u,u.bytes=r;s<l;)t=S.getUint32(s),u.push(t),s+=4;for(l+=3;s<l;)t=h[s++],u.push(t);let A=r<16?St(r):Ct(r);return u.string=A??mt(r)}const Wt=(r,t)=>{let e=_().map(l=>l.toString()),u=r;t!==void 0&&(r=r<32?-((t<<5)+r):(t<<5)+r,e.highByte=t);let s=v[r];return s&&(s.isShared||Z)&&((v.restoreStructures||(v.restoreStructures=[]))[r]=s),v[r]=e,e.read=bt(e,u),e.read()};V[0]=()=>{},V[0].noBuffer=!0,V[66]=r=>{let t=r.length,e=BigInt(128&r[0]?r[0]-256:r[0]);for(let u=1;u<t;u++)e<<=8n,e+=BigInt(r[u]);return e};let ue={Error,TypeError,ReferenceError};V[101]=()=>{let r=_();return(ue[r[0]]||Error)(r[1])},V[105]=r=>{let t=S.getUint32(n-4);$||($=new Map);let e,u=h[n];e=u>=144&&u<160||u==220||u==221?[]:{};let s={target:e};$.set(t,s);let l=_();return s.used?Object.assign(e,l):(s.target=l,l)},V[112]=r=>{let t=S.getUint32(n-4),e=$.get(t);return e.used=!0,e.target},V[115]=()=>new Set(_());const $t=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array");let ae=typeof globalThis=="object"?globalThis:window;V[116]=r=>{let t=r[0],e=$t[t];if(!e)throw new Error("Could not find typed array for code "+t);return new ae[e](Uint8Array.prototype.slice.call(r,1).buffer)},V[120]=()=>{let r=_();return new RegExp(r[0],r[1])};const le=[];function qt(r){let t=J,e=n,u=L,s=W,l=K,d=$,A=T,N=new Uint8Array(h.slice(0,J)),j=v,x=v.slice(0,v.length),M=B,P=Z,F=r();return J=t,n=e,L=u,W=s,K=l,$=d,T=A,h=N,Z=P,(v=j).splice(0,v.length,...x),B=M,S=new DataView(h.buffer,h.byteOffset,h.byteLength),F}function vt(){h=null,$=null,v=null}V[98]=r=>{let t=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],e=n;return n+=t-r.length,T=le,(T=[Lt(),Lt()]).position0=0,T.position1=0,T.postBundlePosition=n,n=e,_()},V[255]=r=>r.length==4?new Date(1e3*(16777216*r[0]+(r[1]<<16)+(r[2]<<8)+r[3])):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+1e3*(4294967296*(3&r[3])+16777216*r[4]+(r[5]<<16)+(r[6]<<8)+r[7])):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+1e3*((128&r[4]?-281474976710656:0)+1099511627776*r[6]+4294967296*r[7]+16777216*r[8]+(r[9]<<16)+(r[10]<<8)+r[11])):new Date("invalid");const At=new Array(147);for(let r=0;r<256;r++)At[r]=+("1e"+Math.floor(45.15-.30103*r));var ct=new it({useRecords:!1});ct.unpack,ct.unpackMultiple,ct.unpack;let ft,It,Kt,ce=new Float32Array(1);new Uint8Array(ce.buffer,0,4);try{ft=new TextEncoder}catch{}const ht=typeof Buffer<"u",gt=ht?function(r){return Buffer.allocUnsafeSlow(r)}:Uint8Array,Zt=ht?Buffer:Uint8Array,Gt=ht?4294967296:2144337920;let o,nt,I,D,i=0,O=null;const fe=/[\u0080-\uFFFF]/,Y=Symbol("record-id");class Ht extends it{constructor(t){let e,u,s,l;super(t),this.offset=0;let d=Zt.prototype.utf8Write?function(a,g){return o.utf8Write(a,g,4294967295)}:!(!ft||!ft.encodeInto)&&function(a,g){return ft.encodeInto(a,o.subarray(g)).written},A=this;t||(t={});let N=t&&t.sequential,j=t.structures||t.saveStructures,x=t.maxSharedStructures;if(x==null&&(x=j?32:0),x>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&t.moreTypes==null&&(this.moreTypes=!0);let M=t.maxOwnStructures;M==null&&(M=j?32:64),this.structures||t.useRecords==0||(this.structures=[]);let P=x>32||M+x>64,F=x+64,G=x+M+64;if(G>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let z=[],dt=0,st=0;this.pack=this.encode=function(a,g){if(o||(o=new gt(8192),I=o.dataView||(o.dataView=new DataView(o.buffer,0,8192)),i=0),D=o.length-10,D-i<2048?(o=new gt(o.length),I=o.dataView||(o.dataView=new DataView(o.buffer,0,o.length)),D=o.length-10,i=0):i=i+7&2147483640,e=i,g&pe&&(i+=255&g),l=A.structuredClone?new Map:null,A.bundleStrings&&typeof a!="string"?(O=[],O.size=1/0):O=null,s=A.structures,s){s.uninitialized&&(s=A._mergeStructures(A.getStructures()));let c=s.sharedLength||0;if(c>x)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+s.sharedLength);if(!s.transitions){s.transitions=Object.create(null);for(let f=0;f<c;f++){let b=s[f];if(!b)continue;let w,y=s.transitions;for(let m=0,U=b.length;m<U;m++){let R=b[m];w=y[R],w||(w=y[R]=Object.create(null)),y=w}y[Y]=f+64}this.lastNamedStructuresLength=c}N||(s.nextId=c+64)}let p;u&&(u=!1);try{A.randomAccessStructure&&a&&a.constructor&&a.constructor===Object?ee(a):k(a);let c=O;if(O&&Yt(e,k,0),l&&l.idsToInsert){let f=l.idsToInsert.sort((m,U)=>m.offset>U.offset?1:-1),b=f.length,w=-1;for(;c&&b>0;){let m=f[--b].offset+e;m<c.stringsPosition+e&&w===-1&&(w=0),m>c.position+e?w>=0&&(w+=6):(w>=0&&(I.setUint32(c.position+e,I.getUint32(c.position+e)+w),w=-1),c=c.previous,b++)}w>=0&&c&&I.setUint32(c.position+e,I.getUint32(c.position+e)+w),i+=6*f.length,i>D&&q(i),A.offset=i;let y=function(m,U){let R,C=6*U.length,et=m.length-C;for(;R=U.pop();){let ut=R.offset,at=R.id;m.copyWithin(ut+C,ut,et),C-=6;let Q=ut+C;m[Q++]=214,m[Q++]=105,m[Q++]=at>>24,m[Q++]=at>>16&255,m[Q++]=at>>8&255,m[Q++]=255&at,et=ut}return m}(o.subarray(e,i),f);return l=null,y}return A.offset=i,g&ge?(o.start=e,o.end=i,o):o.subarray(e,i)}catch(c){throw p=c,c}finally{if(s&&(Ot(),u&&A.saveStructures)){let c=s.sharedLength||0,f=o.subarray(e,i),b=function(w,y){return w.isCompatible=m=>{let U=!m||(y.lastNamedStructuresLength||0)===m.length;return U||y._mergeStructures(m),U},w}(s,A);if(!p)return A.saveStructures(b,b.isCompatible)===!1?A.pack(a,g):(A.lastNamedStructuresLength=c,f)}g&de&&(i=e)}};const Ot=()=>{st<10&&st++;let a=s.sharedLength||0;if(s.length>a&&!N&&(s.length=a),dt>1e4)s.transitions=null,st=0,dt=0,z.length>0&&(z=[]);else if(z.length>0&&!N){for(let g=0,p=z.length;g<p;g++)z[g][Y]=0;z=[]}},pt=a=>{var g=a.length;g<16?o[i++]=144|g:g<65536?(o[i++]=220,o[i++]=g>>8,o[i++]=255&g):(o[i++]=221,I.setUint32(i,g),i+=4);for(let p=0;p<g;p++)k(a[p])},k=a=>{i>D&&(o=q(i));var g,p=typeof a;if(p==="string"){let c,f=a.length;if(O&&f>=4&&f<4096){if((O.size+=f)>21760){let y,m,U=(O[0]?3*O[0].length+O[1].length:0)+10;i+U>D&&(o=q(i+U)),O.position?(m=O,o[i]=200,i+=3,o[i++]=98,y=i-e,i+=4,Yt(e,k,0),I.setUint16(y+e-3,i-e-y)):(o[i++]=214,o[i++]=98,y=i-e,i+=4),O=["",""],O.previous=m,O.size=0,O.position=y}let w=fe.test(a);return O[w?0:1]+=a,o[i++]=193,void k(w?-f:f)}c=f<32?1:f<256?2:f<65536?3:5;let b=3*f;if(i+b>D&&(o=q(i+b)),f<64||!d){let w,y,m,U=i+c;for(w=0;w<f;w++)y=a.charCodeAt(w),y<128?o[U++]=y:y<2048?(o[U++]=y>>6|192,o[U++]=63&y|128):(64512&y)==55296&&(64512&(m=a.charCodeAt(w+1)))==56320?(y=65536+((1023&y)<<10)+(1023&m),w++,o[U++]=y>>18|240,o[U++]=y>>12&63|128,o[U++]=y>>6&63|128,o[U++]=63&y|128):(o[U++]=y>>12|224,o[U++]=y>>6&63|128,o[U++]=63&y|128);g=U-i-c}else g=d(a,i+c);g<32?o[i++]=160|g:g<256?(c<2&&o.copyWithin(i+2,i+1,i+1+g),o[i++]=217,o[i++]=g):g<65536?(c<3&&o.copyWithin(i+3,i+2,i+2+g),o[i++]=218,o[i++]=g>>8,o[i++]=255&g):(c<5&&o.copyWithin(i+5,i+3,i+3+g),o[i++]=219,I.setUint32(i,g),i+=4),i+=g}else if(p==="number")if(a>>>0===a)a<32||a<128&&this.useRecords===!1||a<64&&!this.randomAccessStructure?o[i++]=a:a<256?(o[i++]=204,o[i++]=a):a<65536?(o[i++]=205,o[i++]=a>>8,o[i++]=255&a):(o[i++]=206,I.setUint32(i,a),i+=4);else if(a>>0===a)a>=-32?o[i++]=256+a:a>=-128?(o[i++]=208,o[i++]=a+256):a>=-32768?(o[i++]=209,I.setInt16(i,a),i+=2):(o[i++]=210,I.setInt32(i,a),i+=4);else{let c;if((c=this.useFloat32)>0&&a<4294967296&&a>=-2147483648){let f;if(o[i++]=202,I.setFloat32(i,a),c<4||(f=a*At[(127&o[i])<<1|o[i+1]>>7])>>0===f)return void(i+=4);i--}o[i++]=203,I.setFloat64(i,a),i+=8}else if(p==="object"||p==="function")if(a){if(l){let f=l.get(a);if(f){if(!f.id){let b=l.idsToInsert||(l.idsToInsert=[]);f.id=b.push(f)}return o[i++]=214,o[i++]=112,I.setUint32(i,f.id),void(i+=4)}l.set(a,{offset:i-e})}let c=a.constructor;if(c===Object)ot(a,!0);else if(c===Array)pt(a);else if(c===Map)if(this.mapAsEmptyObject)o[i++]=128;else{(g=a.size)<16?o[i++]=128|g:g<65536?(o[i++]=222,o[i++]=g>>8,o[i++]=255&g):(o[i++]=223,I.setUint32(i,g),i+=4);for(let[f,b]of a)k(f),k(b)}else{for(let f=0,b=It.length;f<b;f++)if(a instanceof Kt[f]){let w=It[f];if(w.write){w.type&&(o[i++]=212,o[i++]=w.type,o[i++]=0);let C=w.write.call(this,a);return void(C===a?Array.isArray(a)?pt(a):ot(a):k(C))}let y,m=o,U=I,R=i;o=null;try{y=w.pack.call(this,a,C=>(o=m,m=null,i+=C,i>D&&q(i),{target:o,targetView:I,position:i-C}),k)}finally{m&&(o=m,I=U,i=R,D=o.length-10)}return void(y&&(y.length+i>D&&q(y.length+i),i=he(y,o,i,w.type)))}if(Array.isArray(a))pt(a);else{if(a.toJSON){const f=a.toJSON();if(f!==a)return k(f)}if(p==="function")return k(this.writeFunction&&this.writeFunction(a));ot(a,!a.hasOwnProperty)}}}else o[i++]=192;else if(p==="boolean")o[i++]=a?195:194;else if(p==="bigint"){if(a<BigInt(1)<<BigInt(63)&&a>=-(BigInt(1)<<BigInt(63)))o[i++]=211,I.setBigInt64(i,a);else if(a<BigInt(1)<<BigInt(64)&&a>0)o[i++]=207,I.setBigUint64(i,a);else{if(!this.largeBigIntToFloat){if(this.useBigIntExtension&&a<2n**1023n&&a>-(2n**1023n)){o[i++]=199,i++,o[i++]=66;let c,f=[];do{let b=0xffn&a;c=(0x80n&b)===(a<0n?0x80n:0n),f.push(b),a>>=8n}while(a!==0n&&-1n!==a||!c);o[i-2]=f.length;for(let b=f.length;b>0;)o[i++]=Number(f[--b]);return}throw new RangeError(a+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension or set largeBigIntToFloat to convert to float-64")}o[i++]=203,I.setFloat64(i,Number(a))}i+=8}else{if(p!=="undefined")throw new Error("Unknown type: "+p);this.encodeUndefinedAsNil?o[i++]=192:(o[i++]=212,o[i++]=0,o[i++]=0)}},kt=this.variableMapSize||this.coercibleKeyAsNumber?a=>{let g,p=Object.keys(a),c=p.length;if(c<16?o[i++]=128|c:c<65536?(o[i++]=222,o[i++]=c>>8,o[i++]=255&c):(o[i++]=223,I.setUint32(i,c),i+=4),this.coercibleKeyAsNumber)for(let f=0;f<c;f++){g=p[f];let b=Number(g);k(isNaN(b)?g:b),k(a[g])}else for(let f=0;f<c;f++)k(g=p[f]),k(a[g])}:(a,g)=>{o[i++]=222;let p=i-e;i+=2;let c=0;for(let f in a)(g||a.hasOwnProperty(f))&&(k(f),k(a[f]),c++);o[p+++e]=c>>8,o[p+e]=255&c},_t=this.useRecords===!1?kt:t.progressiveRecords&&!P?(a,g)=>{let p,c,f=s.transitions||(s.transitions=Object.create(null)),b=i++-e;for(let w in a)if(g||a.hasOwnProperty(w)){if(p=f[w],p)f=p;else{let y=Object.keys(a),m=f;f=s.transitions;let U=0;for(let R=0,C=y.length;R<C;R++){let et=y[R];p=f[et],p||(p=f[et]=Object.create(null),U++),f=p}b+e+1==i?(i--,wt(f,y,U)):Et(f,y,b,U),c=!0,f=m[w]}k(a[w])}if(!c){let w=f[Y];w?o[b+e]=w:Et(f,Object.keys(a),b,0)}}:(a,g)=>{let p,c=s.transitions||(s.transitions=Object.create(null)),f=0;for(let w in a)(g||a.hasOwnProperty(w))&&(p=c[w],p||(p=c[w]=Object.create(null),f++),c=p);let b=c[Y];b?b>=96&&P?(o[i++]=96+(31&(b-=96)),o[i++]=b>>5):o[i++]=b:wt(c,c.__keys__||Object.keys(a),f);for(let w in a)(g||a.hasOwnProperty(w))&&k(a[w])},xt=typeof this.useRecords=="function"&&this.useRecords,ot=xt?(a,g)=>{xt(a)?_t(a,g):kt(a,g)}:_t,q=a=>{let g;if(a>16777216){if(a-e>Gt)throw new Error("Packed buffer would be larger than maximum buffer size");g=Math.min(Gt,4096*Math.round(Math.max((a-e)*(a>67108864?1.25:2),4194304)/4096))}else g=1+(Math.max(a-e<<2,o.length-1)>>12)<<12;let p=new gt(g);return I=p.dataView||(p.dataView=new DataView(p.buffer,0,g)),a=Math.min(a,o.length),o.copy?o.copy(p,0,e,a):p.set(o.slice(e,a)),i-=e,e=0,D=p.length-10,o=p},wt=(a,g,p)=>{let c=s.nextId;c||(c=64),c<F&&this.shouldShareStructure&&!this.shouldShareStructure(g)?(c=s.nextOwnId,c<G||(c=F),s.nextOwnId=c+1):(c>=G&&(c=F),s.nextId=c+1);let f=g.highByte=c>=96&&P?c-96>>5:-1;a[Y]=c,a.__keys__=g,s[c-64]=g,c<F?(g.isShared=!0,s.sharedLength=c-63,u=!0,f>=0?(o[i++]=96+(31&c),o[i++]=f):o[i++]=c):(f>=0?(o[i++]=213,o[i++]=114,o[i++]=96+(31&c),o[i++]=f):(o[i++]=212,o[i++]=114,o[i++]=c),p&&(dt+=st*p),z.length>=M&&(z.shift()[Y]=0),z.push(a),k(g))},Et=(a,g,p,c)=>{let f=o,b=i,w=D,y=e;o=nt,i=0,e=0,o||(nt=o=new gt(8192)),D=o.length-10,wt(a,g,c),nt=o;let m=i;if(o=f,i=b,D=w,e=y,m>1){let U=i+m-1;U>D&&q(U);let R=p+e;o.copyWithin(R+m,R+1,i),o.set(nt.slice(0,m),R),i=U}else o[p+e]=nt[0]},ee=(a,g)=>{let p=(void 0)(a,o,e,i,s,q,(c,f,b)=>{if(b)return u=!0;i=f;let w=o;return k(c),Ot(),w!==o?{position:i,targetView:I,target:o}:i},this);if(p===0)return ot(a,!0);i=p}}useBuffer(t){o=t,I=new DataView(o.buffer,o.byteOffset,o.byteLength),i=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function Qt(r,t,e,u){let s=r.byteLength;if(s+1<256){var{target:l,position:d}=e(4+s);l[d++]=199,l[d++]=s+1}else if(s+1<65536){var{target:l,position:d}=e(5+s);l[d++]=200,l[d++]=s+1>>8,l[d++]=s+1&255}else{var{target:l,position:d,targetView:A}=e(7+s);l[d++]=201,A.setUint32(d,s+1),d+=4}l[d++]=116,l[d++]=t,l.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),d)}function Xt(r,t){let e=r.byteLength;var u,s;if(e<256){var{target:u,position:s}=t(e+2);u[s++]=196,u[s++]=e}else if(e<65536){var{target:u,position:s}=t(e+3);u[s++]=197,u[s++]=e>>8,u[s++]=255&e}else{var{target:u,position:s,targetView:l}=t(e+5);u[s++]=198,l.setUint32(s,e),s+=4}u.set(r,s)}function he(r,t,e,u){let s=r.length;switch(s){case 1:t[e++]=212;break;case 2:t[e++]=213;break;case 4:t[e++]=214;break;case 8:t[e++]=215;break;case 16:t[e++]=216;break;default:s<256?(t[e++]=199,t[e++]=s):s<65536?(t[e++]=200,t[e++]=s>>8,t[e++]=255&s):(t[e++]=201,t[e++]=s>>24,t[e++]=s>>16&255,t[e++]=s>>8&255,t[e++]=255&s)}return t[e++]=u,t.set(r,e),e+=s}function Yt(r,t,e){if(O.length>0){I.setUint32(O.position+r,i+e-O.position-r),O.stringsPosition=i-r;let u=O;O=null,t(u[0]),t(u[1])}}Kt=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Tt],It=[{pack(r,t,e){let u=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&u>=0&&u<4294967296){let{target:s,targetView:l,position:d}=t(6);s[d++]=214,s[d++]=255,l.setUint32(d,u)}else if(u>0&&u<4294967296){let{target:s,targetView:l,position:d}=t(10);s[d++]=215,s[d++]=255,l.setUint32(d,4e6*r.getMilliseconds()+(u/1e3/4294967296>>0)),l.setUint32(d+4,u)}else if(isNaN(u)){if(this.onInvalidDate)return t(0),e(this.onInvalidDate());let{target:s,targetView:l,position:d}=t(3);s[d++]=212,s[d++]=255,s[d++]=255}else{let{target:s,targetView:l,position:d}=t(15);s[d++]=199,s[d++]=12,s[d++]=255,l.setUint32(d,1e6*r.getMilliseconds()),l.setBigInt64(d+4,BigInt(Math.floor(u)))}}},{pack(r,t,e){if(this.setAsEmptyObject)return t(0),e({});let u=Array.from(r),{target:s,position:l}=t(this.moreTypes?3:0);this.moreTypes&&(s[l++]=212,s[l++]=115,s[l++]=0),e(u)}},{pack(r,t,e){let{target:u,position:s}=t(this.moreTypes?3:0);this.moreTypes&&(u[s++]=212,u[s++]=101,u[s++]=0),e([r.name,r.message])}},{pack(r,t,e){let{target:u,position:s}=t(this.moreTypes?3:0);this.moreTypes&&(u[s++]=212,u[s++]=120,u[s++]=0),e([r.source,r.flags])}},{pack(r,t){this.moreTypes?Qt(r,16,t):Xt(ht?Buffer.from(r):new Uint8Array(r),t)}},{pack(r,t){let e=r.constructor;e!==Zt&&this.moreTypes?Qt(r,$t.indexOf(e.name),t):Xt(r,t)}},{pack(r,t){let{target:e,position:u}=t(1);e[u]=193}}];let te=new Ht({useRecords:!1});te.pack,te.pack;const tt=Ht,ge=512,de=1024,pe=2048;async function we(){await ye(()=>({a:1e3,b:!0,c:{d:{e:{f:1e3}}},z:new Uint8Array([34,0,0,0,241,98,92,191,255,255,255,255,4,0,109,234,6,20,109,247,209,11,107,30,34,15,110,220,163,50,204,3,129,30,173,43,0,2,86,104,65,63,27,191,23,23])}))}class Bt extends re{constructor(t,e,u){super(),this.encode=e,this.decode=u,this.data=t,this.encodedData=e(t)}async encoding(){return this.encode(this.data)}async decoding(){return this.decode(this.encodedData)}}const ye=async r=>{let t=new X,e=new tt;new X({structuredClone:!0}),new tt({structuredClone:!0}),new X({structuredClone:!0,useRecords:!0}),new tt({structuredClone:!0,useRecords:!0}),new X({structuredClone:!0,structures:[]}),new X({structuredClone:!0,structures:[],useRecords:!0}),new X({structures:[],useRecords:!0}),new tt({structuredClone:!0,structures:[]}),new tt({structuredClone:!0,structures:[],useRecords:!0}),new tt({structures:[],useRecords:!0}),new Array,await new Bt(r(),JSON.stringify,JSON.parse).run({name:"JSON"}),await new Bt(r(),t.encode.bind(t),t.decode.bind(t)).run({name:"CBOR"}),await new Bt(r(),e.encode.bind(e),e.decode.bind(e)).run({name:"MSGPack"})};export{we as m};
